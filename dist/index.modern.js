import e,{createContext as t,useState as n,useRef as r,useContext as o,useEffect as l,useMemo as a,Component as i}from"react";import s from"lodash";import{ChatEngineContext as c,getLatestChats as d,getLatestMessages as u,readMessage as p,getChat as m,TextInput as f,Button as h,newChat as g,getChatsBefore as q,Avatar as v,removePerson as b,AutoCompleteInput as y,addPerson as x,getOtherPeople as w,deleteChat as k,editChat as E,Dot as C,isTyping as S,sendMessage as N}from"react-chat-engine";import M from"axios";import{WebSocket as T}from"nextjs-websocket";import{LoadingOutlined as O,CloseOutlined as I,PlusOutlined as z,DeleteOutlined as D,UserAddOutlined as R,MenuOutlined as j,LeftOutlined as F,SettingOutlined as A,FileOutlined as P,CloseCircleTwoTone as L,PaperClipOutlined as B,ArrowUpOutlined as $,SyncOutlined as H,CaretDownOutlined as W}from"@ant-design/icons";import{useSpring as V,animated as K}from"react-spring";import{setConfiguration as U,Row as G,Col as J}from"react-grid-system";import Y from"react-html-parser";import{animateScroll as X}from"react-scroll";function Z(e){if(!e)return new Date;var t=new Date(e);return isNaN(t.getFullYear())&&(t=new Date(e.replace(" ","T"))),t}function Q(e){var t=e.toLocaleString("en-US");return t.split(" ")[1].slice(0,-3)+" "+t.slice(-2)}function ee(e){return e.toLocaleString("en-US")}var te=t(),ne=function(t){var r=n(!0),o=r[0],l=r[1],a=n(null),i=a[0],s=a[1],c=n(null),d=c[0],u=c[1],p=n(""),m=p[0],f=p[1],h=n(null),g=h[0],q=h[1],v=n({}),b=v[0],y=v[1],x=n(null),w=x[0],k=x[1],E=n({}),C=E[0],S=E[1],N=n(!1),_=N[0],M=N[1],T=n(!1);return e.createElement(te.Provider,{value:{connecting:o,setConnecting:l,conn:i,setConn:s,creds:d,setCreds:u,sessionToken:m,setSessionToken:f,chats:g,setChats:q,messages:b,setMessages:y,activeChat:w,setActiveChat:k,typingCounter:C,setTypingCounter:S,loadMoreMessages:_,setLoadMoreMessages:M,isBottomVisible:T[0],setIsBottomVisible:T[1],userCallbacks:{translate:function(e,n,r){if(!t.translate)return r||e;var o=t.translate(e,n,r);return o||"string"==typeof o?o:r||e},formatDateTime:function(e,n){if(t.formatDateTime)return t.formatDateTime(e,n);switch(n){case"date":return ee(e);case"time":return Q(e);case"datetime":return function(e){return Q(e)+", "+ee(e)}(e);case"ago":return function(e){return e.toString().substr(4,6)}(e);default:return""}},openAttachment:function(e,n){t.openAttachment?t.openAttachment(e,n):window.open(e.file)},htmlMessageTransform:"function"==typeof t.htmlMessageTransform?t.htmlMessageTransform:null,onMessageSent:"function"==typeof t.onMessageSent?t.onMessageSent:null}}},t.children)};function re(){return(re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function oe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,function(e,t){(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function le(e){return e&&e.development?"http://127.0.0.1:8000":"https://api.chatengine.io"}function ae(e){return e?e.chatID?{"public-key":e.publicKey?e.publicKey:e.projectID,"chat-id":e.chatID,"access-key":e.chatAccessKey}:{"Public-Key":e.publicKey?e.publicKey:e.projectID,"User-Name":e.userName,"User-Secret":e.userPassword?e.userPassword:e.userSecret}:void 0}var ie=function(t){var n=r(!1),a=o(c),i=a.setConn,s=a.setCreds,p=a.setSessionToken,m=a.setChats,f=a.setActiveChat,h=a.setMessages;return l(function(){n.current||(n.current=!0,function e(){!function(e,t,n){M.get(le(e)+"/users/me/session/",{headers:ae(e)}).then(function(e){t&&t(e.data)}).catch(function(e){console.log("Get or Create Session Error",e),n&&n(e)})}(t,function(e){i(t),s(t),p(e.token)},function(n){n.response&&403===n.response.status&&(console.log("Your login credentials were not correct: \n\n                        Project ID: "+t.projectID+" \n\n                        Username: "+t.userName+" \n\n                        User Secret: "+t.userSecret+"\n\n                        Double check these credentials to make sure they're correct.\n\n                        If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),i(void 0),s(void 0),t.onFailAuth&&t.onFailAuth(t)),setTimeout(function(){return e()},3e3)})}(),d(t,25,function(e){return function(e){var n=function(e){return Object.values(e).sort(function(e,t){var n=Z(e.last_message.created?e.last_message.created:e.created);return Z(t.last_message.created?t.last_message.created:t.created).getTime()-n.getTime()})}(e),r=n[0]?parseInt(n[0].id):0;m(_.mapKeys(e,"id")),f(r),u(t,r,45,function(e,t){h(_.mapKeys(t,"created"))})}(e)}))}),e.createElement("div",null)},se=void 0,ce=0,de=0,ue=Date.now()+1e4,pe=function(t){var r=n(Date.now()),a=r[0],i=r[1],s=n(Date.now()+15e3),m=s[0],f=s[1],h=o(c),g=h.connecting,q=h.setConnecting,v=h.conn,b=h.sessionToken,y=h.chats,x=h.setChats,w=h.messages,k=h.setMessages,E=h.activeChat,C=h.setActiveChat,S=h.typingCounter,N=h.setTypingCounter,M=h.isBottomVisible;function O(e){if(y){var n=re({},y);n[e.id]=e,x(n)}t.onEditChat&&t.onEditChat(e)}l(function(){a>m&&(console.log("pingIntervalID",ce),console.log("timeIntervalID",de),console.log("shouldPongBy",m),console.log("now",a),q(!0),t.reRender&&t.reRender(),f(Date.now()+15e3))},[a,m]),l(function(){return function(){clearInterval(ce),clearInterval(de)}},[]);var I=t.development;return b&&""!==b?e.createElement(T,{url:(I?"ws://":"wss://")+(I?"127.0.0.1:8000":"api.chatengine.io")+"/person_v4/?session_token="+b,reconnect:!0,reconnectIntervalInMilliSeconds:3e3,childRef:function(e){return se=e},onOpen:function(e){console.log("connected"),q(!1),g&&(ce=setInterval(function(){try{se.sendMessage(JSON.stringify("ping"))}catch(e){console.log("Socker error",e)}},4e3),de=setInterval(function(){return i(Date.now())},1e3)),d(e,25,function(e){return x(_.mapKeys(e,"id"))}),(Date.now()>ue||e.renderChatFeed)&&u(e,E,45,function(e,t){k(re({},w,_.mapKeys(t,"created")))}),t.onConnect&&t.onConnect(e)}.bind(void 0,t),onError:function(e){return console.log("Socket Error",e)},onMessage:function(e){try{var n=JSON.parse(e);if("pong"===n.action)f(Date.now()+15e3);else if("new_chat"===n.action){var r=n.data;if(y){var o=re({},y);o[r.id]=r,x(o),C(r.id)}t.onNewChat&&t.onNewChat(n.data)}else if("edit_chat"===n.action)O(n.data);else if("delete_chat"===n.action){var l=n.data;if(y&&(y[l.id]=void 0,x(y),!_.isEmpty(y))){var a=function(e){return Object.values(e).sort(function(e,t){var n=Z(e.last_message.created?e.last_message.created:e.created);return Z(t.last_message.created?t.last_message.created:t.created).getTime()-n.getTime()})}(y);C(a[0]?parseInt(a[0].id):0)}t.onDeleteChat&&t.onDeleteChat(l)}else if("add_person"===n.action)O(n.data),t.onAddPerson&&t.onAddPerson(n.data);else if("remove_person"===n.action)O(n.data),t.onRemovePerson&&t.onRemovePerson(n.data);else if("new_message"===n.action){var i=n.data,s=i.id,c=i.message;if(parseInt(s)===parseInt(E)){var d=re({},w);d[c.created]=c,k(d)}c.sender_username!==t.userName&&M&&p(v,E,c.id,function(e){return O(e)}),t.onNewMessage&&t.onNewMessage(s,c)}else if("edit_message"===n.action){var u=n.data,m=u.id,h=u.message;m===E&&(w[h.created]=h,k(w)),t.onEditMessage&&t.onEditMessage(m,h)}else if("delete_message"===n.action){var g=n.data,q=g.id,b=g.message;q===E&&(w[b.created]=void 0,k(w)),t.onDeleteMessage&&t.onDeleteMessage(q,b)}else if("is_typing"===n.action){var T,I,z=n.data,D=z.id,R=z.person,j=re({},S);j=re({},j,((I={})[D]=re({},j[D],((T={})[R]=Date.now(),T)),I)),N(j),t.onTyping&&t.onTyping(D,R)}return Promise.resolve()}catch(e){return Promise.reject(e)}}.bind(void 0),onClose:function(){console.log("Socket Closed"),q(!0),t.reRender&&t.reRender()}}):e.createElement("div",null)},me=function(t){var r=n(!1),o=r[0],l=r[1];return e.createElement("div",null,!o&&e.createElement(ie,t),!o&&e.createElement(pe,re({},t,{reRender:function(){return l(!0),void setTimeout(function(){return l(!1)},100)}})))},fe=void 0,he=0,ge=0,qe=Date.now()+1e4,ve=function(t){var r=n(Date.now()),a=r[0],i=r[1],d=n(Date.now()+15e3),p=d[0],f=d[1],h=o(c),g=h.connecting,q=h.setConnecting,v=h.conn,b=h.setConn,y=h.setCreds,x=h.chats,w=h.setChats,k=h.messages,E=h.setMessages,C=h.activeChat,S=h.setActiveChat,N=h.typingCounter,_=h.setTypingCounter;function M(e){if(x){var n=re({},x);n[e.id]=e,w(n)}t.onEditChat&&t.onEditChat(e)}l(function(){a>p&&(console.log("shouldPongBy",p),console.log("now",a),q(!0),t.reRender&&t.reRender(),f(Date.now()+15e3))},[a,p]),l(function(){return function(){clearInterval(he),clearInterval(ge)}},[]);var O=t.development;return e.createElement(T,{reconnect:!0,childRef:function(e){return fe=e},url:(O?"ws://":"wss://")+(O?"127.0.0.1:8000":"api.chatengine.io")+"/chat/?projectID="+(t.publicKey||t.projectID)+"&chatID="+t.chatID+"&accessKey="+t.chatAccessKey,onOpen:function(e){b(e),y(e),q(!1),g&&(he=setInterval(function(){try{fe.sendMessage(JSON.stringify("ping"))}catch(e){console.log("Socker error",e)}},4e3),ge=setInterval(function(){return i(Date.now())},1e3)),m(e,t.chatID,function(e){return function(e){null===C&&S(e.id),w(s.mapKeys([e],"id"))}(e)}),Date.now()>qe&&u(e,t.chatID,45,function(e,t){E(re({},k,s.mapKeys(t,"created")))}),t.onConnect&&t.onConnect(e)}.bind(void 0,t),onClose:function(){q(!0),t.reRender&&t.reRender()}.bind(void 0),onError:function(e){return console.log("Socket Error",e)},onMessage:function(e){var n=JSON.parse(e);if("pong"===n.action)f(Date.now()+15e3);else if("login_error"===n.action)console.log("Your chat auth credentials were not correct: \n\n                Project ID: "+t.projectID+" \n\n                Chat ID: "+t.chatID+" \n\n                Access Key: "+t.chatAccessKey+"\n\n                Double check these credentials to make sure they're correct.\n\n                If all three are correct, try resetting the username and secret in the Online Dashboard or Private API."),b(void 0),y(void 0),t.onFailAuth&&t.onFailAuth(v);else if("edit_chat"===n.action)M(n.data);else if("delete_chat"===n.action){var r=n.data;x&&(x[r.id]=void 0,w(x)),t.onDeleteChat&&t.onDeleteChat(r)}else if("add_person"===n.action)M(n.data),t.onAddPerson&&t.onAddPerson(n.data);else if("remove_person"===n.action)M(n.data),t.onRemovePerson&&t.onRemovePerson(n.data);else if("new_message"===n.action){var o=n.data,l=o.id,a=o.message;if(l===C){var i=re({},k);i[a.created]=a,E(i)}t.onNewMessage&&t.onNewMessage(l,a)}else if("edit_message"===n.action){var s=n.data,c=s.id,d=s.message;c===C&&(k[d.created]=d,E(k)),t.onEditMessage&&t.onEditMessage(c,d)}else if("delete_message"===n.action){var u=n.data,p=u.id,m=u.message;p===C&&(k[m.created]=void 0,E(k)),t.onDeleteMessage&&t.onDeleteMessage(p,m)}else if("is_typing"===n.action){var h,g,q=n.data,S=q.id,T=q.person,O=re({},N);O=re({},O,((g={})[S]=re({},O[S],((h={})[T]=Date.now(),h)),g)),_(O),t.onTyping&&t.onTyping(S,T)}}.bind(void 0),reconnectIntervalInMilliSeconds:3e3})},be=function(t){var r=n(!1),o=r[1];return e.createElement("div",null,!r[0]&&e.createElement(ve,re({},t,{reRender:function(){return o(!0),void setTimeout(function(){return o(!1)},100)}})))},ye=function(t){var o=r();return function(e){var r=n(!1)[1],o=new IntersectionObserver(function(e){var n=e[0];r(n.isIntersecting),n.isIntersecting&&t.onVisible()});l(function(){return o.observe(e.current),function(){o.disconnect()}},[])}(o),e.createElement("div",{ref:o},e.createElement("div",{style:{textAlign:"center",backgroundColor:"#e2e2e2",margin:"4px",borderRadius:"4px"}},e.createElement(O,{style:{fontSize:"21px",padding:"24px"}})))},xe=function(t){var r=o(te),l=r.conn,a=r.userCallbacks.translate,i=n(""),s=i[0],c=i[1],d=n(!1),u=d[0],p=d[1];return e.createElement("div",null,t.onClose&&e.createElement("div",{style:{height:"0px"}},e.createElement(I,{style:we.closeIcon,onClick:function(){return t.onClose()}})),e.createElement("div",{className:"ce-chat-form-container",style:re({},we.newChatContainer,{marginLeft:t.onClose?"40px":"0px"})},u?e.createElement("form",{onSubmit:function(e){e.preventDefault(),l&&s.trim().length>0&&g(l,{title:s},function(){return p(!1)}),c("")}.bind(void 0)},e.createElement(f,{autoFocus:!0,label:a("Chat Title","NewChatForm"),value:s,id:"ce-new-chat-title-field",onBlur:function(){return p(!1)},style:{width:"100%"},handleChange:function(e){c(e.target.value)}})):e.createElement("div",null,e.createElement("div",{style:{height:"0px"}},e.createElement("div",{style:{fontWeight:"600",fontSize:"24px",position:"relative",top:"4px",width:"calc(100% - 48px)"}},a("My Chats","NewChatForm"))),e.createElement("div",{style:{width:"100%",textAlign:"right"}},e.createElement(h,{icon:"plus",id:"new-chat-plus-button",onClick:function(){return p(!0)}})))))},we={closeIcon:{position:"relative",top:"26px",left:"18px",fontSize:"16px"},newChatContainer:{padding:"16px 14px",backgroundColor:"white"}},ke=function(){return e.createElement("div",{style:Ee.chatContainer,className:"ce-chat-card ce-chat-card-loading"},e.createElement("div",{style:re({},Ee.titleText,{animation:"spin 2s linear infinite"}),className:"ce-chat-title-text",id:"ce-chat-card-title-loading"},e.createElement("div",{className:"ce-chat-card-loading-bar",style:re({},Ee.loadingBar,{marginBottom:"8px",height:"16px",width:"100%"})})),e.createElement("div",{style:{width:"100%"},className:"ce-chat-subtitle"},e.createElement("div",{style:Ee.messageText,className:"ce-chat-subtitle-text ce-chat-subtitle-message"},e.createElement("div",{className:"ce-chat-card-loading-bar",style:re({},Ee.loadingBar,{width:"45%"})})),e.createElement("div",{className:"ce-chat-card-loading-bar",style:re({},Ee.loadingBar,{float:"right",marginTop:"6px",width:"20%"})})))},Ee={chatContainer:{padding:"16px",paddingBottom:"12px",cursor:"pointer"},titleText:{fontWeight:"500",paddingBottom:"4px",whiteSpace:"nowrap",overflow:"hidden"},messageText:{width:"75%",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block"},loadingBar:{borderRadius:"4px",backgroundColor:"#e2e2e2",height:"12px",display:"inline-block"}},Ce=["children","triggers"],Se=function(t){var n=t.children,r=t.triggers,o=void 0===r?[]:r,l=function(t){var n=t.x,r=void 0===n?0:n,o=t.y,l=void 0===o?0:o,a=t.rotation,i=void 0===a?0:a,s=t.scale,c=void 0===s?1:s,d=t.timing,u=void 0===d?150:d,p=t.springConfig,m=void 0===p?{tension:300,friction:10}:p,f=t.width,h=void 0===f?"auto":f,g=e.useState(!1),q=g[0],v=g[1],b=V({display:"inline-block",backfaceVisibility:"hidden",transform:q?"translate("+r+"px, "+l+"px)\n            rotate("+i+"deg)\n            scale("+c+")":"translate(0px, 0px)\n            rotate(0deg)\n            scale(1)",config:m,width:h});return e.useEffect(function(){if(q){var e=window.setTimeout(function(){v(!1)},u);return function(){window.clearTimeout(e)}}},[q]),[b,e.useCallback(function(){v(!0)},[])]}(function(e,t){if(null==e)return{};var n,r,o={},l=Object.keys(e);for(r=0;r<l.length;r++)t.indexOf(n=l[r])>=0||(o[n]=e[n]);return o}(t,Ce)),a=l[1];function i(e){return-1!==o.indexOf(e)}return e.createElement(K.span,{style:l[0],onClick:function(){return i("onClick")&&a()},onMouseEnter:function(){return i("onMouseEnter")&&a()},onMouseLeave:function(){return i("onMouseLeave")&&a()}},n)},Ne=require("html-to-text").htmlToText,_e=function(t){var n=t.chat,r=o(c),l=r.conn,a=r.activeChat,i=r.setActiveChat,d=r.userCallbacks,u=d.formatDateTime,p=d.translate;if(s.isEmpty(n)||t.loading)return e.createElement(ke,null);var m=!!t.spinner&&e.createElement("div",{style:{display:"inline-block",border:"10px solid #f3f3f3",borderTop:"10px solid #3498db",borderRadius:"50%",width:"1.5em",height:"1.5em",marginRight:"0.3em",animation:"rotate360 1s linear infinite"}});if(!l||null===l)return e.createElement("div",null);var f,h=a===n.id?Me.activeChat:{},g=n.people.find(function(e){return l.userName!==e.person.username}),q=n.is_direct_chat&&g?g.person.username:n.title,v=Ne(n.last_message.text,{});function b(e){var t=!0;return e.people.map(function(n){l.userName===n.person.username&&(t=e.last_message.id===n.last_read)}),t}return v||(v=n.last_message.attachments.length>0?n.last_message.attachments.length+" image"+(n.last_message.attachments.length>1?"s":""):p("Say hello!","ChatCard")),e.createElement(Se,{triggers:["onClick","onMouseEnter"],x:3,timing:60,width:"100%"},e.createElement("div",{onClick:function(){return!t.spinner&&i(n.id)},style:re({},Me.chatContainer,h),className:"ce-chat-card "+(a===n.id&&"ce-active-chat-card")},e.createElement("div",{style:Me.titleText,className:"ce-chat-title-text",id:"ce-chat-card-title-"+q},e.createElement("div",{style:{width:!b(n)&&"calc(100% - 18px)",overflowX:"hidden",display:"inline-block"}},m,q),!b(n)&&e.createElement("div",{className:"ce-chat-unread-dot",style:{marginTop:"5px",width:"12px",height:"12px",borderRadius:"6px",backgroundColor:"#1890ff",float:"right",display:"inline-block"}})),e.createElement("div",{style:{width:"100%"},className:"ce-chat-subtitle"},e.createElement("div",{style:Me.messageText,className:"ce-chat-subtitle-text ce-chat-subtitle-message"},v),e.createElement("div",{className:"ce-chat-subtitle-text ce-chat-subtitle-date",style:re({},Me.messageText,{textAlign:"right",width:"25%"})},(f=n.last_message.created)?u(Z(f),"ago"):""))))},Me={chatContainer:{padding:"16px",paddingBottom:"12px",cursor:"pointer"},titleText:{fontWeight:"500",paddingBottom:"4px",whiteSpace:"nowrap",overflow:"hidden"},messageText:{width:"75%",color:"rgba(153, 153, 153, 1)",fontSize:"14px",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block"},activeChat:{backgroundColor:"#d9d9d9",border:"0px solid white",borderRadius:"12px"}},Te=function(t){var i=r(!1),u=n(!1),p=u[0],m=u[1],f=n(!1),h=f[0],g=f[1],v=n(!0),b=v[0],y=v[1],x=o(c),w=x.conn,k=x.chats,E=x.setChats,C=x.setActiveChat,S=_(k?Object.values(k):[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}]),N=a(function(){return!(!h&&!p)},[h,p]);function _(e){return e.sort(function(e,t){var n=Z(e.last_message&&e.last_message.created?e.last_message.created:e.created),r=Z(t.last_message&&t.last_message.created?t.last_message.created:t.created);return new Date(r)-new Date(n)})}function M(e){g(!1);var t=null!==k?k:{},n=s.mapKeys(re({},e),"id"),r=re({},t,n);E(r),33>e.length&&y(!1)}return l(function(){i.current||(i.current=!0,m(!0),d(t,33,function(e){M(e),e.length>0&&C(e[0].id),m(!1)}))}),l(function(){if(h&&"loading"!==h){g("loading");var e=(null!==k?_(Object.values(k)):[]).filter(function(e){return e});e.length>0&&q(t,e[e.length-1].created,33,function(e){return M(e)})}},[h]),e.createElement("div",{style:Oe.chatListContainer,className:"ce-chat-list"},e.createElement("div",{style:Oe.chatsContainer,className:"ce-chats-container"},t.renderNewChatForm?t.renderNewChatForm(w):e.createElement(xe,{onClose:t.onClose?function(){return t.onClose()}:void 0}),function(n){return n.map(function(n,r){return n?t.renderChatCard?e.createElement("div",{key:"chat_"+r},t.renderChatCard(n,r)):e.createElement("div",{key:"chat_"+r,onClick:function(){return!N&&t.onChatClick&&t.onChatClick(n.id)}},e.createElement(_e,{chat:n,spinner:N})):e.createElement("div",{key:"chat_"+r})})}(S),b&&S.length>0&&e.createElement("div",null,e.createElement(ye,{onVisible:function(){return!h&&g(!0)}}),e.createElement("div",{style:{height:"8px"}}))))},Oe={chatListContainer:{height:"100%",maxHeight:"100vh",overflow:"scroll",overflowX:"hidden",borderRight:"1px solid #afafaf",backgroundColor:"white"},chatsContainer:{width:"100%",height:"100%",backgroundColor:"white",borderRadius:"0px 0px 24px 24px"}},Ie=function(t){var n=o(c);return e.createElement("div",{id:"ce-login-fail-breaker",style:{width:"100%",textAlign:"center",paddingTop:"calc(50% - 112px)"}},e.createElement("div",{id:"ce-login-fail-text",style:{color:"#afafaf",fontWeight:"600",fontSize:"14px",marginBottom:"6px",marginRight:"32px",marginLeft:"32px"}},(0,n.userCallbacks.translate)("Your credentials are incorrect. Make sure your Project ID, Username, and Password are correct here","AuthFail")),e.createElement("img",{id:"ce-login-fail-gif",style:{width:"50%",maxWidth:"200px"},src:"https://chat-engine-assets.s3.amazonaws.com/welcome_gifs/no.gif",alt:"chat-engine-login-fail"}))};function ze(e,t){M.get(le(e)+"/chats/",{headers:ae(e)}).then(function(n){e.onGetChats&&e.onGetChats(n.data),t&&t(n.data)}).catch(function(e){console.log("Fetch Chats Error",e)})}function De(e,t,n){M.post(le(e)+"/chats/",t,{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("New Chat Error",e)})}function Re(e,t,n){M.get(le(e)+"/chats/latest/"+t+"/",{headers:ae(e)}).then(function(t){e.onGetChats&&e.onGetChats(t.data),n&&n(t.data)}).catch(function(e){console.log("Fetch Chats Error",e)})}function je(e,t,n,r){M.put(le(e)+"/chats/latest/"+n+"/",{before:t},{headers:ae(e)}).then(function(t){e.onGetChats&&e.onGetChats(t.data),r&&r(t.data)}).catch(function(e){console.log("Fetch Chats Before Error",e)})}function Fe(e,t,n){M.put(le(e)+"/chats/",t,{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("Get or Create Chat Error",e)})}function Ae(e,t,n){M.get(le(e)+"/chats/"+t+"/",{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("Get Chat Error",e)})}function Pe(e,t,n,r){M.patch(le(e)+"/chats/"+t+"/",n,{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("Edit Chat Error",e)})}function Le(e,t,n){M.delete(le(e)+"/chats/"+t+"/",{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("Delete Chat Error",e)})}function Be(e,t){return e(t={exports:{}},t.exports),t.exports
/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */}var $e="function"==typeof Symbol&&Symbol.for,He=$e?Symbol.for("react.element"):60103,We=$e?Symbol.for("react.portal"):60106,Ve=$e?Symbol.for("react.fragment"):60107,Ke=$e?Symbol.for("react.strict_mode"):60108,Ue=$e?Symbol.for("react.profiler"):60114,Ge=$e?Symbol.for("react.provider"):60109,Je=$e?Symbol.for("react.context"):60110,Ye=$e?Symbol.for("react.async_mode"):60111,Xe=$e?Symbol.for("react.concurrent_mode"):60111,Ze=$e?Symbol.for("react.forward_ref"):60112,Qe=$e?Symbol.for("react.suspense"):60113,et=$e?Symbol.for("react.suspense_list"):60120,tt=$e?Symbol.for("react.memo"):60115,nt=$e?Symbol.for("react.lazy"):60116,rt=$e?Symbol.for("react.block"):60121,ot=$e?Symbol.for("react.fundamental"):60117,lt=$e?Symbol.for("react.responder"):60118,at=$e?Symbol.for("react.scope"):60119;function it(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case He:switch(e=e.type){case Ye:case Xe:case Ve:case Ue:case Ke:case Qe:return e;default:switch(e=e&&e.$$typeof){case Je:case Ze:case nt:case tt:case Ge:return e;default:return t}}case We:return t}}}function st(e){return it(e)===Xe}var ct={AsyncMode:Ye,ConcurrentMode:Xe,ContextConsumer:Je,ContextProvider:Ge,Element:He,ForwardRef:Ze,Fragment:Ve,Lazy:nt,Memo:tt,Portal:We,Profiler:Ue,StrictMode:Ke,Suspense:Qe,isAsyncMode:function(e){return st(e)||it(e)===Ye},isConcurrentMode:st,isContextConsumer:function(e){return it(e)===Je},isContextProvider:function(e){return it(e)===Ge},isElement:function(e){return"object"==typeof e&&null!==e&&e.$$typeof===He},isForwardRef:function(e){return it(e)===Ze},isFragment:function(e){return it(e)===Ve},isLazy:function(e){return it(e)===nt},isMemo:function(e){return it(e)===tt},isPortal:function(e){return it(e)===We},isProfiler:function(e){return it(e)===Ue},isStrictMode:function(e){return it(e)===Ke},isSuspense:function(e){return it(e)===Qe},isValidElementType:function(e){return"string"==typeof e||"function"==typeof e||e===Ve||e===Xe||e===Ue||e===Ke||e===Qe||e===et||"object"==typeof e&&null!==e&&(e.$$typeof===nt||e.$$typeof===tt||e.$$typeof===Ge||e.$$typeof===Je||e.$$typeof===Ze||e.$$typeof===ot||e.$$typeof===lt||e.$$typeof===at||e.$$typeof===rt)},typeOf:it},dt=Be(function(e,t){"production"!==process.env.NODE_ENV&&function(){var e="function"==typeof Symbol&&Symbol.for,n=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,o=e?Symbol.for("react.fragment"):60107,l=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,s=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,d=e?Symbol.for("react.concurrent_mode"):60111,u=e?Symbol.for("react.forward_ref"):60112,p=e?Symbol.for("react.suspense"):60113,m=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,h=e?Symbol.for("react.lazy"):60116,g=e?Symbol.for("react.block"):60121,q=e?Symbol.for("react.fundamental"):60117,v=e?Symbol.for("react.responder"):60118,b=e?Symbol.for("react.scope"):60119;function y(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:var m=e.type;switch(m){case c:case d:case o:case a:case l:case p:return m;default:var g=m&&m.$$typeof;switch(g){case s:case u:case h:case f:case i:return g;default:return t}}case r:return t}}}var x=d,w=s,k=i,E=n,C=u,S=o,N=h,_=f,M=r,T=a,O=l,I=p,z=!1;function D(e){return y(e)===d}t.AsyncMode=c,t.ConcurrentMode=x,t.ContextConsumer=w,t.ContextProvider=k,t.Element=E,t.ForwardRef=C,t.Fragment=S,t.Lazy=N,t.Memo=_,t.Portal=M,t.Profiler=T,t.StrictMode=O,t.Suspense=I,t.isAsyncMode=function(e){return z||(z=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),D(e)||y(e)===c},t.isConcurrentMode=D,t.isContextConsumer=function(e){return y(e)===s},t.isContextProvider=function(e){return y(e)===i},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return y(e)===u},t.isFragment=function(e){return y(e)===o},t.isLazy=function(e){return y(e)===h},t.isMemo=function(e){return y(e)===f},t.isPortal=function(e){return y(e)===r},t.isProfiler=function(e){return y(e)===a},t.isStrictMode=function(e){return y(e)===l},t.isSuspense=function(e){return y(e)===p},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===d||e===a||e===l||e===p||e===m||"object"==typeof e&&null!==e&&(e.$$typeof===h||e.$$typeof===f||e.$$typeof===i||e.$$typeof===s||e.$$typeof===u||e.$$typeof===q||e.$$typeof===v||e.$$typeof===b||e.$$typeof===g)},t.typeOf=y}()}),ut=Be(function(e){e.exports="production"===process.env.NODE_ENV?ct:dt}),pt=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable;function ht(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var gt=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,o=ht(e),l=1;l<arguments.length;l++){for(var a in n=Object(arguments[l]))mt.call(n,a)&&(o[a]=n[a]);if(pt){r=pt(n);for(var i=0;i<r.length;i++)ft.call(n,r[i])&&(o[r[i]]=n[r[i]])}}return o},qt="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",vt=Function.call.bind(Object.prototype.hasOwnProperty),bt=function(){};if("production"!==process.env.NODE_ENV){var yt=qt,xt={},wt=vt;bt=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}}function kt(e,t,n,r,o){if("production"!==process.env.NODE_ENV)for(var l in e)if(wt(e,l)){var a;try{if("function"!=typeof e[l]){var i=Error((r||"React class")+": "+n+" type `"+l+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[l]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw i.name="Invariant Violation",i}a=e[l](t,l,r,n,null,yt)}catch(e){a=e}if(!a||a instanceof Error||bt((r||"React class")+": type specification of "+n+" `"+l+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof a+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),a instanceof Error&&!(a.message in xt)){xt[a.message]=!0;var s=o?o():"";bt("Failed "+n+" type: "+a.message+(null!=s?s:""))}}}kt.resetWarningCache=function(){"production"!==process.env.NODE_ENV&&(xt={})};var Et=kt,Ct=function(){};function St(){return null}function Nt(){}function _t(){}"production"!==process.env.NODE_ENV&&(Ct=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}}),_t.resetWarningCache=Nt;var Mt=Be(function(e){e.exports="production"!==process.env.NODE_ENV?function(e,t){var n="function"==typeof Symbol&&Symbol.iterator,r={array:i("array"),bigint:i("bigint"),bool:i("boolean"),func:i("function"),number:i("number"),object:i("object"),string:i("string"),symbol:i("symbol"),any:a(St),arrayOf:function(e){return a(function(t,n,r,o,a){if("function"!=typeof e)return new l("Property `"+a+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var i=t[n];if(!Array.isArray(i))return new l("Invalid "+o+" `"+a+"` of type `"+d(i)+"` supplied to `"+r+"`, expected an array.");for(var s=0;s<i.length;s++){var c=e(i,s,r,o,a+"["+s+"]",qt);if(c instanceof Error)return c}return null})},element:a(function(t,n,r,o,a){var i=t[n];return e(i)?null:new l("Invalid "+o+" `"+a+"` of type `"+d(i)+"` supplied to `"+r+"`, expected a single ReactElement.")}),elementType:a(function(e,t,n,r,o){var a=e[t];return ut.isValidElementType(a)?null:new l("Invalid "+r+" `"+o+"` of type `"+d(a)+"` supplied to `"+n+"`, expected a single ReactElement type.")}),instanceOf:function(e){return a(function(t,n,r,o,a){var i;return t[n]instanceof e?null:new l("Invalid "+o+" `"+a+"` of type `"+((i=t[n]).constructor&&i.constructor.name?i.constructor.name:"<<anonymous>>")+"` supplied to `"+r+"`, expected instance of `"+(e.name||"<<anonymous>>")+"`.")})},node:a(function(e,t,n,r,o){return c(e[t])?null:new l("Invalid "+r+" `"+o+"` supplied to `"+n+"`, expected a ReactNode.")}),objectOf:function(e){return a(function(t,n,r,o,a){if("function"!=typeof e)return new l("Property `"+a+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var i=t[n],s=d(i);if("object"!==s)return new l("Invalid "+o+" `"+a+"` of type `"+s+"` supplied to `"+r+"`, expected an object.");for(var c in i)if(vt(i,c)){var u=e(i,c,r,o,a+"."+c,qt);if(u instanceof Error)return u}return null})},oneOf:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Ct(arguments.length>1?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array."),St;function t(t,n,r,a,i){for(var s=t[n],c=0;c<e.length;c++)if(o(s,e[c]))return null;var d=JSON.stringify(e,function(e,t){return"symbol"===u(t)?String(t):t});return new l("Invalid "+a+" `"+i+"` of value `"+String(s)+"` supplied to `"+r+"`, expected one of "+d+".")}return a(t)},oneOfType:function(e){if(!Array.isArray(e))return"production"!==process.env.NODE_ENV&&Ct("Invalid argument supplied to oneOfType, expected an instance of array."),St;for(var t=0;t<e.length;t++){var n=e[t];if("function"!=typeof n)return Ct("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+p(n)+" at index "+t+"."),St}return a(function(t,n,r,o,a){for(var i=[],s=0;s<e.length;s++){var c=(0,e[s])(t,n,r,o,a,qt);if(null==c)return null;c.data&&vt(c.data,"expectedType")&&i.push(c.data.expectedType)}return new l("Invalid "+o+" `"+a+"` supplied to `"+r+"`"+(i.length>0?", expected one of type ["+i.join(", ")+"]":"")+".")})},shape:function(e){return a(function(t,n,r,o,a){var i=t[n],c=d(i);if("object"!==c)return new l("Invalid "+o+" `"+a+"` of type `"+c+"` supplied to `"+r+"`, expected `object`.");for(var p in e){var m=e[p];if("function"!=typeof m)return s(r,o,a,p,u(m));var f=m(i,p,r,o,a+"."+p,qt);if(f)return f}return null})},exact:function(e){return a(function(t,n,r,o,a){var i=t[n],c=d(i);if("object"!==c)return new l("Invalid "+o+" `"+a+"` of type `"+c+"` supplied to `"+r+"`, expected `object`.");var p=gt({},t[n],e);for(var m in p){var f=e[m];if(vt(e,m)&&"function"!=typeof f)return s(r,o,a,m,u(f));if(!f)return new l("Invalid "+o+" `"+a+"` key `"+m+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var h=f(i,m,r,o,a+"."+m,qt);if(h)return h}return null})}};function o(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function l(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function a(e){function t(t,n,r,o,a,i,s){if(o=o||"<<anonymous>>",i=i||r,s!==qt){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}return null==n[r]?t?new l(null===n[r]?"The "+a+" `"+i+"` is marked as required in `"+o+"`, but its value is `null`.":"The "+a+" `"+i+"` is marked as required in `"+o+"`, but its value is `undefined`."):null:e(n,r,o,a,i)}process;var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function i(e){return a(function(t,n,r,o,a,i){var s=t[n];return d(s)!==e?new l("Invalid "+o+" `"+a+"` of type `"+u(s)+"` supplied to `"+r+"`, expected `"+e+"`.",{expectedType:e}):null})}function s(e,t,n,r,o){return new l((e||"React class")+": "+t+" type `"+n+"."+r+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+o+"`.")}function c(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(c);if(null===t||e(t))return!0;var r=function(e){var t=e&&(n&&e[n]||e["@@iterator"]);if("function"==typeof t)return t}(t);if(!r)return!1;var o,l=r.call(t);if(r!==t.entries){for(;!(o=l.next()).done;)if(!c(o.value))return!1}else for(;!(o=l.next()).done;){var a=o.value;if(a&&!c(a[1]))return!1}return!0;default:return!1}}function d(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||!!t&&("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function u(e){if(null==e)return""+e;var t=d(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function p(e){var t=u(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}return l.prototype=Error.prototype,r.checkPropTypes=Et,r.resetWarningCache=Et.resetWarningCache,r.PropTypes=r,r}(ut.isElement):function(){function e(e,t,n,r,o,l){if(l!==qt){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:_t,resetWarningCache:Nt};return n.PropTypes=n,n}()}),Tt=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={focused:!1,value:null},e}oe(n,t);var r=n.prototype;return r.componentDidMount=function(){var e=this.props.default;e&&(this.props.handleChange({target:{value:e}}),this.setState({value:e}))},r.render=function(){var t=this;return e.createElement("input",{id:this.props.id,autoFocus:this.props.autoFocus,className:"ce-input ce-text-input",value:this.props.value,placeholder:this.props.label,style:re({},this.state.focused?Ot.focusInput:Ot.input,this.props.style?this.props.style:{}),onBlur:function(){t.setState({focused:!1}),t.props.onBlur&&t.props.onBlur()},onFocus:function(){t.setState({focused:!0}),t.props.onFocus&&t.props.onFocus()},type:this.props.type?this.props.type:"text",onChange:function(e){return t.props.handleChange&&t.props.handleChange(e)}})},n}(i),Ot={input:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",border:"1px solid #d9d9d9",padding:"0px 12px",boxSizing:"border-box"},focusInput:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",border:"1px solid #1890ff",padding:"0px 12px",boxSizing:"border-box"}};Tt.propTypes={default:Mt.string,value:Mt.string,label:Mt.string,type:Mt.oneOf(["text","password","number"]),autoFocus:Mt.bool,id:Mt.string,style:Mt.object,handleChange:Mt.func,onFocus:Mt.func,onBlur:Mt.func};var It,zt=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={focused:!1,showAll:!1},e}oe(n,t);var r=n.prototype;return r.onFocus=function(){this.onChange("",!0),this.setState({focused:!0}),this.props.onFocus&&this.props.onFocus()},r.onBlur=function(){this.setState({focused:!1}),this.props.onBlur&&this.props.onBlur()},r.onChange=function(e,t){this.setState({showAll:t}),this.props.handleChange&&this.props.handleChange(e)},r.getNames=function(){var e=this,t=0,n=this.props.max?this.props.max:3,r=[];return this.props.options.map(function(o){-1!==JSON.stringify(o).toLowerCase().indexOf(e.props.value.toLowerCase())&&(t<n||n<0)&&(t+=1,r.push(o))}),r},r.renderOptions=function(){var t=this;if(!this.props.value&&!this.state.showAll)return e.createElement("div",null);var n=this.getNames();return n.map(function(r,o){return e.createElement("div",{key:"option_"+o,className:"ce-autocomplete-option"},t.props.renderOption&&t.props.renderOption(r),o===n.length-1&&e.createElement("div",{style:Dt.close,className:"ce-autocomplete-close",onClick:function(){return t.onChange("",!1)}},e.createElement(I,null)))})},r.render=function(){var t=this,n=this.props.options,r=this.props.style?this.props.style:{},o=re({},Dt.input,{border:this.state.focused?"1px solid #1890ff":"1px solid #d9d9d9"});return e.createElement("div",null,e.createElement("input",{id:"ce-add-username-input",className:"ce-input ce-autocomplete-input",value:this.props.value,placeholder:this.props.label,style:re({},o,r),type:this.props.type?this.props.type:"text",onBlur:function(){return t.onBlur()},onFocus:function(){return t.onFocus()},onChange:function(e){return t.onChange(e.target.value,!0)}}),n&&n.length>0&&this.state.showAll&&e.createElement("div",{className:"ce-autocomplete-options",style:{borderRadius:"19px",border:"1px solid #afafaf",overflow:"hidden"}},this.props.options&&this.renderOptions()))},n}(i),Dt={input:{height:"36px",fontSize:"15px",outline:"none",borderRadius:"24px",padding:"0px 12px",boxSizing:"border-box"},close:{cursor:"pointer",textAlign:"center",padding:"8px 12px",fontSize:"15px",borderRadius:"24px"}};zt.propTypes={default:Mt.string,value:Mt.string,options:Mt.arrayOf(Mt.object),max:Mt.number,label:Mt.string,type:Mt.oneOf(["text","number"]),style:Mt.object,handleChange:Mt.func,onFocus:Mt.func,onBlur:Mt.func};var Rt=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={hovered:!1},e}return oe(n,t),n.prototype.render=function(){var t=this,n=this.props,r=n.value,o=n.icon,l=n.theme,a=n.onClick;return e.createElement("button",{id:n.id,type:n.type,onClick:function(){return a&&a()},onMouseEnter:function(){return t.setState({hovered:!0})},onMouseLeave:function(){return t.setState({hovered:!1})},style:re({},"danger"===l?jt.dangerButton:jt.button,n.style||{},this.state.hovered?jt.hoverButton:{}),className:"ce-primary-button "+("danger"===l?"ce-danger-button":"")},"plus"===o&&e.createElement(z,null),"delete"===o&&e.createElement(D,null),"user-add"===o&&e.createElement(R,null),r&&o?" "+r:r)},n}(i),jt={button:{color:"white",border:"none",outline:"none",height:"36px",fontSize:"15px",cursor:"pointer",padding:"8px 16px",borderRadius:"33px",backgroundColor:"#1890ff"},dangerButton:(It={color:"red",border:"none",outline:"none",height:"36px",fontSize:"15px",cursor:"pointer",padding:"8px 16px",borderRadius:"33px",backgroundColor:"white"},It.border="1px solid red",It),hoverButton:{opacity:"0.66"}};Rt.propTypes={value:Mt.string,onClick:Mt.func,style:Mt.object,id:Mt.string,icon:Mt.oneOf([void 0,"plus","delete","user-add"]),theme:Mt.oneOf([void 0,"danger"]),type:Mt.oneOf([void 0,"submit"])};var Ft=function(t){var r=o(c).userCallbacks.translate,l=t.conn,a=n(""),i=a[0],s=a[1];return e.createElement("div",{class:"ce-ice-breaker-no-chat"},e.createElement("form",{onSubmit:function(e){e.preventDefault(),i&&De(l,{title:i})}},e.createElement("b",null,r("No chat room found, start by creating one","CreateChat")),e.createElement("br",null),e.createElement(Tt,{type:"text",label:r("Chat room name","CreateChat"),handleChange:function(e){s(e.target.value)}}),e.createElement(Rt,{type:"submit",value:r("Create","CreateChat")})))},At=function(){var t=o(c);return e.createElement("div",{id:"ce-ice-breaker-chat",style:{width:"100%",textAlign:"center",paddingTop:"calc(43% - 112px)"}},e.createElement("div",{id:"ce-ice-breaker-text",style:{color:"#afafaf",fontWeight:"600",fontSize:"14px",marginBottom:"6px"}},(0,t.userCallbacks.translate)("No messages here yet...","IceBreaker")))},Pt=function(t){o(te);var a=r();return function(e){var r=n(!1)[1],o=new IntersectionObserver(function(e){var n=e[0];r(n.isIntersecting),n.isIntersecting?t.onEnter&&t.onEnter():t.onLeave&&t.onLeave()});l(function(){return o.observe(e.current),function(){o.disconnect()}},[])}(a),e.createElement("div",{ref:a,id:t.id},t.children)},Lt=function(t){o(te);var n=t.setIsOpen;return e.createElement("div",null,e.createElement(j,{onClick:function(){return n(!0)},style:{color:"rgb(24, 144, 255)",outline:"none",fontSize:"1.5em"}}))},Bt=function(t){var r=n(!1),o=r[0],l=r[1],a=t.person,i=t.chat,s=t.conn;return a&&i&&s&&null!==s?e.createElement("div",{className:"ce-person-container",onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)}},e.createElement("div",{className:"ce-person-avatar",style:{padding:"2px",height:"0px"}},e.createElement(v,{avatar:a.avatar,username:a.username,is_online:a.is_online})),e.createElement("div",{className:"ce-person-text",style:{paddingLeft:"52px",height:"44px",position:"relative",top:"10px",fontSize:"15px"}},function(e){return e.first_name&&null!==e.first_name?e.first_name+(e.last_name?" "+e.last_name:""):e.username}(a)),o&&s.userName===i.admin.username&&a.username!==i.admin.username&&e.createElement("div",{className:"ce-delete-chat",style:{float:"right",height:"0px",position:"relative",bottom:"44px"}},e.createElement(h,{theme:"danger",icon:"delete",onClick:function(){b(t.conn,t.chat.id,t.person.username)}}))):e.createElement("div",null)};Bt.propTypes={person:Mt.object.isRequired,chat:Mt.object.isRequired,conn:Mt.object};var $t=function(t){var r=n(!1),o=r[1],l=t.person,a=l.avatar,i=l.username;return e.createElement("div",{id:"ce-username-option-"+i,onMouseEnter:function(){return o(!0)},onMouseLeave:function(){return o(!1)},onClick:function(){return t.onClick&&t.onClick()},style:re({},Ht.option,{backgroundColor:r[0]?"#f5f5f5":"white"})},e.createElement("div",null,e.createElement(v,{username:i,avatar:a})),e.createElement("div",{style:{display:"flex",padding:"12px 4px"}},t.person.username))},Ht={option:{padding:"4px 16px",cursor:"pointer",fontSize:"15px",display:"flex"}};$t.propTypes={person:Mt.object.isRequired};var Wt=function(t){var r=o(c).userCallbacks.translate,l=n({value:"",others:[]}),a=l[0],i=l[1];function s(){w(t.conn,t.chat.id,function(e,t){return i(re({},a,{others:t}))},function(){})}return e.createElement("div",{style:{marginBottom:"12px"}},e.createElement(y,{style:{width:"100%"},label:r("Type a username","PersonForm"),value:a.value,options:a.others,onFocus:function(){return s()},handleChange:function(e){return function(e){i(re({},a,{value:e}))}(e)},renderOption:function(n){return function(n){return e.createElement($t,{person:n,onClick:function(){x(t.conn,t.chat.id,n.username,function(){i(re({},a,{value:""})),s()})}})}(n)},max:-1}))};Wt.propTypes={chat:Mt.object.isRequired,conn:Mt.object.isRequired};var Vt=function(t){var r=n(!0),o=r[0],l=r[1],a=n(!1),i=a[1];return e.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},e.createElement("div",{id:t.id,className:t.className,onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},onClick:function(){return l(!o)},style:{cursor:"pointer",backgroundColor:a[0]?"#f0f0f0":"#fff",transition:"background-color 100ms"}},e.createElement("div",{style:{fontSize:"17px",padding:"12px",fontWeight:"600"}},t.label),!t.alwaysOpen&&e.createElement(F,{style:{float:"right",position:"relative",bottom:"30px",right:"12px",transform:o?"rotate(0deg)":"rotate(-90deg)",transition:"transform 100ms"}})),e.createElement("div",null,(!o||t.alwaysOpen)&&t.children))},Kt=function(){var t=o(c),n=t.conn,r=t.chats,l=t.userCallbacks.translate,a=r&&r[t.activeChat];return!a||a.is_direct_chat?e.createElement("div",null):e.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},e.createElement(Vt,{label:l("People","PeopleSettings"),className:"ce-section-title-container ce-person-title-container"},e.createElement("div",null,e.createElement("div",{style:{height:"12px"}}),function(t,r){return t.map(function(t,o){return e.createElement(Bt,{key:"person_"+o,person:t.person,conn:n,chat:r})})}(a.people,a),e.createElement("div",{style:{height:"12px"}}),n&&a&&n.userName===a.admin.username&&e.createElement(Wt,{conn:n,chat:a}))))},Ut=["jpg","jpeg","png","gif","tiff"],Gt=function(e){var t=e.split(".");return t.length>0&&-1!==Ut.indexOf(t[t.length-1].toLowerCase())},Jt=function(e){var t=e.split("/");return t[t.length-1].split("?")[0]},Yt=function(t){var n=o(c).userCallbacks.openAttachment,r=t.attachment;if(!r)return e.createElement("div",null);var l=Jt(r.file);return e.createElement("div",{style:Xt.container,className:"ce-photo-thumbnail",onClick:function(){return n(r,"image")}},e.createElement("div",{style:{paddingTop:"100%"}}),Gt(l)?e.createElement("img",{alt:r.id,style:Xt.image,src:r.file,className:"ce-photo-img",id:"image-"+r.id}):e.createElement("div",{alt:r.id,style:Xt.file,className:"ce-settings-file",id:"image-"+r.id},l))},Xt={container:{position:"relative",width:"calc(33% - 8px)",border:"1px solid white",display:"inline-block",cursor:"pointer"},image:{top:"0px",width:"100%",height:"100%",position:"absolute",objectFit:"cover"},file:{top:"0px",width:"100%",height:"100%",position:"absolute",overflow:"auto",padding:"10px 5px"}};Yt.propTypes={attachment:Mt.object.isRequired};var Zt=function(){var t=o(c),n=t.chats,r=n&&n[t.activeChat];return r?e.createElement("div",{style:{borderTop:"1px solid #f0f0f0"},className:"ce-photo-section"},e.createElement(Vt,{label:(0,t.userCallbacks.translate)("Files","PhotosSettings"),className:"ce-section-title-container ce-photo-title-container"},e.createElement("div",{className:"ce-photo-feed"},e.createElement("div",{style:{height:"12px"}}),r.attachments.map(function(t,n){return e.createElement(Yt,{key:"person_"+n,attachment:t})})))):e.createElement("div",null)},Qt=function(){var t=o(c),n=t.conn,r=t.chats,l=t.userCallbacks.translate,a=r&&r[t.activeChat];return a?e.createElement("div",{style:{borderTop:"1px solid #f0f0f0"}},e.createElement(Vt,{id:"ce-options-drop-down",label:l("Options","OptionsSettings"),alwaysOpen:!0},e.createElement("div",null,e.createElement("div",{style:{height:"8px"}}),e.createElement(h,{value:l("Delete","OptionsSettings"),theme:"danger",icon:"delete",id:"ce-delete-chat-button",onClick:function(){return k(n,a.id,function(e){})},style:{width:"100%",marginBottom:"12px"}})))):e.createElement("div",null)},en=function(t){var a=o(c).userCallbacks.translate,i=r(!1),s=n({activeChat:null,value:""}),d=s[0],u=s[1];return l(function(){i.current?d.activeChat!==t.chat.id&&u(re({},d,{value:t.chat.title,activeChat:t.chat.id})):i.current=!0}),e.createElement("form",{onSubmit:function(e){return e.preventDefault(),void E(t.conn,t.chat.id,{title:d.value},function(e){})},className:"ce-chat-title-form"},e.createElement(f,{label:a("Rename this Chat","NewMessageForm"),value:d.value,default:t.chat.title,handleChange:function(e){u(re({},d,{value:e.target.value}))},style:{fontSize:"16px",fontWeight:"600",textAlign:"center",border:"0px solid white",width:"100%"}}))};en.propTypes={chat:Mt.object.isRequired};var tn,nn=function(){var t=o(c),n=t.conn,r=t.chats,l=r&&r[t.activeChat];if(!l||!n||null===n)return e.createElement("div",null);var a=l.people.slice(0,3),i=l.people.find(function(e){return e.person.username!==n.userName});function s(t){return e.createElement("div",{style:{width:"100%",paddingTop:"14px"}},e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px)"}},e.createElement(v,{show_online:!1,username:t[0].person.username,avatar:t[0].person.avatar})))}return e.createElement("div",{className:"ce-chat-settings-container"},e.createElement("div",{className:"ce-chat-avatars-row"},1===a.length&&s(a),l.is_direct_chat&&i&&s([i]),!l.is_direct_chat&&i&&2===a.length&&function(t){return e.createElement("div",{style:{width:"100%",paddingTop:"14px"}},e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 15px)"}},e.createElement(v,{show_online:!1,username:t[0].person.username,avatar:t[0].person.avatar})),e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 44px - 22px + 15px)"}},e.createElement(v,{show_online:!1,username:t[1].person.username,avatar:t[1].person.avatar})))}(a),!l.is_direct_chat&&i&&3===a.length&&function(t){return e.createElement("div",{style:{width:"100%",paddingTop:"14px"}},e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 24px)"}},e.createElement(v,{show_online:!1,username:t[0].person.username,avatar:t[0].person.avatar})),e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 24px - 44px)"}},e.createElement(v,{show_online:!1,username:t[1].person.username,avatar:t[1].person.avatar})),e.createElement("div",{style:{float:"left",position:"relative",left:"calc(50% - 22px - 44px - 44px + 24px)"}},e.createElement(v,{show_online:!1,username:t[2].person.username,avatar:t[2].person.avatar})))}(a)),l.is_direct_chat&&i?e.createElement("div",{style:{paddingTop:"55px",paddingBottom:"7px",fontSize:"16px",fontWeight:"600",textAlign:"center",border:"0px solid white",width:"100%"}},i.person.username):e.createElement(en,{chat:l,conn:n}))},rn=function(t){var n=o(c),r=n.conn,l=n.chats,a=l&&l[n.activeChat];return null===r?e.createElement("div",null):e.createElement("div",{style:on.settingsContainer,className:"ce-settings"},e.createElement("div",{style:{width:"90%",paddingLeft:"5%"},className:"ce-settings-container"},t.renderChatSettingsTop?t.renderChatSettingsTop(r,a):e.createElement(nn,null),t.renderPeopleSettings?t.renderPeopleSettings(r,a):e.createElement(Kt,null),t.renderPhotosSettings?t.renderPhotosSettings(a):e.createElement(Zt,null),r&&a&&r.userName===a.admin.username&&e.createElement("div",null,t.renderOptionsSettings?t.renderOptionsSettings(r,a):e.createElement(Qt,null))))},on={settingsContainer:(tn={height:"100%",overflow:"scroll",overflowX:"hidden",borderLeft:"1px solid #afafaf",backgroundColor:"white",flex:"1"},tn.overflow="auto",tn.paddingBottom="10px",tn)},ln=function(t){o(c);var n=t.setIsOpen;return e.createElement("div",null,e.createElement(A,{onClick:function(){return n(!0)},style:{color:"rgb(24, 144, 255)",outline:"none",fontSize:"1.5em"}}))};U({maxScreenClass:"xl",gutterWidth:0});var an,sn,cn=function(t){var n=o(c),r=n.conn,l=n.chats,a=n.userCallbacks,i=a.translate,s=a.formatDateTime,d=l?l[n.activeChat]:void 0,u=d&&r&&d.people.find(function(e){return e.person.username!==r.userName}),p=d?d.is_direct_chat&&u?u.person.username:d.title:void 0,m=i("Say hello!","ChatHeader");if(d){if(d.last_message.created&&d.last_message.created.length>0){var f=Z(d.last_message.created);m=i("Active","ChatHeader")+" "+s(f,"ago")}}else m=i("Loading...","ChatHeader");return e.createElement(G,{className:"ce-chat-title",style:dn.titleSection},e.createElement(J,{xs:2,sm:0,style:re({},dn.mobileOptiom,{left:"6px"}),className:"ce-chat-list-mobile-option"},e.createElement(Lt,{setIsOpen:t.setChatListIsOpen})),e.createElement(J,{xs:8,sm:12,style:dn.titleContainer,className:"ce-chat-title-container"},e.createElement("div",{style:dn.titleText,className:"ce-chat-title-text",id:"ce-chat-feed-title-"+p},p||e.createElement(O,null)),e.createElement("div",{style:dn.subtitleText,className:"ce-chat-subtitle-text"},m)),e.createElement(J,{xs:2,sm:0,style:re({},dn.mobileOptiom,{right:"6px"}),className:"ce-chat-settings-mobile-option"},e.createElement(ln,{setIsOpen:t.setChatSettingsIsOpen})))},dn={titleSection:{position:"absolute",top:"0px",width:"100%",zIndex:"1",backgroundColor:"rgb(256, 256, 256, 0.92)"},mobileOptiom:{width:"100%",top:"32px",textAlign:"center",color:"rgb(24, 144, 255)",overflow:"hidden"},titleContainer:{width:"100%",padding:"18px 0px",textAlign:"center",color:"rgb(24, 144, 255)",overflowX:"hidden"},titleText:{fontSize:"24px",fontWeight:"600"},subtitleText:{fontSize:"12px"}},un=function(t){var n=t.chatListIsOpen,r=t.setChatListIsOpen,l=o(te),a=re({},t,l.conn);return e.createElement("div",null,n&&e.createElement("div",{style:pn.drawerContainer},null!==l.conn&&l.conn.renderChatList?l.conn.renderChatList(l):e.createElement(Te,re({},a,{onClose:function(){return r(!1)},onChatClick:function(){return r(!1)}}))))},pn={drawerContainer:{position:"absolute",zIndex:"1",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:"white",textAlign:"left"},titleContainer:{width:"100%",padding:"24px 0px",textAlign:"center",color:"rgb(24, 144, 255)"},titleText:{fontSize:"24px",fontWeight:"600"}},mn=function(t){var n=t.chatSettingsIsOpen,r=t.setChatSettingsIsOpen,l=o(c),a=l.userCallbacks.translate,i=re({},t,l.conn);return e.createElement("div",{className:"ce-chat-settings"},n&&e.createElement("div",{style:fn.drawerContainer},e.createElement(I,{style:fn.closeIcon,onClick:function(){return r(!1)}}),e.createElement("div",{style:fn.titleContainer},e.createElement("div",{style:fn.titleText},a("Chat Settings","ChatSettingsDrawer"))),null!==l.conn&&l.conn.renderChatSettings?l.conn.renderChatSettings(l):e.createElement(rn,i)))},fn={drawerContainer:{position:"absolute",zIndex:"1",top:"0px",left:"0px",width:"100%",height:"100%",backgroundColor:"white",textAlign:"left",display:"flex",flexFlow:"column"},closeIcon:{position:"absolute",left:"28px",top:"32px"},titleContainer:{width:"100%",padding:"24px 0px",textAlign:"center",color:"rgb(24, 144, 255)"},titleText:{fontSize:"24px",fontWeight:"600"}},hn=function(t){var n=o(c).userCallbacks.formatDateTime,r=t.lastCreated,l=t.created;function a(e){return e?e.substr(0,10):null}var i=a(r),s=a(l);return r&&i===s?e.createElement("div",null):e.createElement("div",{style:gn.dateText,className:"ce-message-date-text"},n(Z(l),"datetime"))},gn={dateText:{width:"100%",textAlign:"center",paddingTop:"4px",paddingBottom:"10px",fontSize:"15px",color:"rgba(0, 0, 0, .40)"}},qn=function(t){var r=o(c).userCallbacks.openAttachment,l=n(!1),a=l[1],i=t.attachment,s=re({},vn.thumbnail,{border:l[0]?"1px solid #1890ff":"1px solid #fff"});return i?e.createElement("img",{onClick:function(){return r(i,"image")},onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)},src:i.file,alt:"thumb-nail",style:s}):e.createElement("div",{style:vn.loadingContainer},e.createElement(O,{style:{color:"white",padding:"4px",fontSize:"24px"}}))},vn={loadingContainer:(an={width:"100%",cursor:"pointer",textAlign:"right",display:"inline-block",objectFit:"cover",borderRadius:"0.3em",marginRight:"2px",marginBottom:"4px",height:"30vw"},an.width="30vw",an.maxHeight="200px",an.maxWidth="200px",an.minHeight="100px",an.minWidth="100px",an.backgroundColor="#d9d9d9",an),thumbnail:(sn={width:"100%",cursor:"pointer",textAlign:"right",display:"inline",objectFit:"cover",borderRadius:"0.3em",paddingRight:"2px",height:"30vw"},sn.width="30vw",sn.maxHeight="200px",sn.maxWidth="200px",sn.minHeight="100px",sn.minWidth="100px",sn)},bn=function(t){var r=o(c).userCallbacks.openAttachment,l=n(!1),a=l[0],i=l[1],s=t.attachment,d=re({},yn.fileView,{color:a?"#1890ff":"#434343",border:a?"1px solid #1890ff":"1px solid #434343"});return s?e.createElement("div",{style:d,onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)},onClick:function(){return r(s,"file")}},e.createElement(P,null)," ",Jt(s.file)):e.createElement("div",{style:yn.loadingContainer},e.createElement(O,{style:{color:"white",padding:"4px",fontSize:"24px"}}))},yn={loadingContainer:{display:"inline-block",borderRadius:"14px",marginRight:"2px",height:"48px",width:"136px",marginBottom:"4px",marginLeft:"4px",backgroundColor:"#d9d9d9"},fileView:{padding:"12px",borderRadius:"14px",display:"inline-block",marginBottom:"4px",marginRight:"2px",cursor:"pointer"}},xn=["#D64045","#5B3000","#00CC99","#467599","#1D3354","#8F250C","#6153CC","#961D4E","#A29F15","#0CAADC","#FF5154","#FA7921","#688E26","#550527","#A10702","#FF1053","#6C6EA0","#100B00"];function wn(e){return e?xn[function(e){for(var t=0,n=0;n<e.length;n++)t=t+e.charCodeAt(n)*n-97;return t}(e)%xn.length]:"black"}var kn=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={avatar:""},e}oe(n,t);var r=n.prototype;return r.updateImg=function(){var e=this.props.avatar;(e=e&&null!==e?e:"").split("?")[0]!==this.state.avatar.split("?")[0]&&this.setState({avatar:e})},r.componentDidMount=function(){this.updateImg()},r.componentDidUpdate=function(){this.updateImg()},r.render=function(){var t=wn(this.props.username);return e.createElement("div",{className:"ce-avatar-dot",style:re({},En.dot,this.props.style?this.props.style:{},{backgroundColor:this.state.avatar?"white":t,backgroundImage:this.state.avatar&&"url("+this.state.avatar+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"14px",width:this.props.visible?"13px":"0px",height:this.props.visible?"13px":"0px"})})},n}(i),En={dot:{borderRadius:"13px",textAlign:"center",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"}};kn.propTypes={avatar:Mt.string,username:Mt.string,style:Mt.object};var Cn=function(t){var n=o(c).userCallbacks.htmlMessageTransform,r=t.text?t.text:"";r=r.replaceAll("<p>","<div>").replaceAll("</p>","</div>").replaceAll("<a ",'<a style="color: '+(t.myMessage?"white":"#1890ff")+';" ');var l={};return n&&(l.transform=n),e.createElement("div",{className:"ce_message"},Y(r,l))};U({maxScreenClass:"xl"});var Sn=function(t){var r=o(c).userCallbacks.formatDateTime,l=n(!1),a=l[0],i=l[1],s=t.lastMessage,d=t.message,u=t.nextMessage;if(!d)return e.createElement("div",null);var p=d&&d.attachments&&d.attachments,m="1.3em "+(s&&s.sender_username===d.sender_username?"0.3em":"1.3em")+" "+(u&&u.sender_username===d.sender_username?"0.3em":"1.3em")+" 1.3em";return e.createElement("div",{className:"ce-message-row ce-my-message",style:{width:"100%",textAlign:"right",paddingBottom:u&&u.sender_username===d.sender_username?"2px":"12px"}},e.createElement("div",{style:{display:"auto"},className:"ce-my-message-attachments-container ce-my-message-images-container"},function(){var n=t.message;return(n&&n.attachments?n.attachments:[]).map(function(t,n){var r=Jt(t.file?t.file:t.name);return Gt(r)?e.createElement(qn,{attachment:t.file&&t,key:"attachment_"+n}):e.createElement("div",{key:"attachment"+n})})}()),e.createElement("div",{style:{display:"auto"},className:"ce-my-message-attachments-container ce-my-message-files-container"},function(){var n=t.message;return(n&&n.attachments?n.attachments:[]).map(function(t,n){var r=Jt(t.file?t.file:t.name);return Gt(r)?e.createElement("div",{key:"attachment"+n}):e.createElement(bn,{attachment:t.file&&t,key:"attachment_"+n})})}()),e.createElement(G,{style:{paddingRight:"2px"},className:"ce-message-bubble-row ce-my-message-bubble-row"},e.createElement(J,{xs:12,sm:12,md:12},e.createElement("span",{className:"ce-message-timestamp ce-my-message-timestamp",style:re({},Nn.timeTag,{opacity:a?"1":"0"})},r(Z(d.created),"time")),!p||d.text&&e.createElement("div",{className:"\n                                ce-message-bubble \n                                ce-my-message-bubble \n                                "+(t.sending&&"ce-my-message-sinding-bubble")+"\n                            ",style:re({},Nn.myMessage,{borderRadius:m},{backgroundColor:t.sending?"#40a9ff":"rgb(24, 144, 255)"}),onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)}},e.createElement(Cn,{myMessage:!0,text:d.text}))),e.createElement(J,{xs:1,sm:2,md:3})))},Nn={myMessage:{color:"white",cursor:"pointer",float:"right",textAlign:"left",padding:"12px",fontSize:"15px",whiteSpace:"pre-line",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},timeTag:{position:"relative",top:"calc(50% - 12px)",right:"8px",fontSize:"14px",color:"rgb(24, 144, 255)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"}};U({maxScreenClass:"xl"});var _n=function(t){var r=o(c).userCallbacks.formatDateTime,l=n(!1),a=l[0],i=l[1],s=t.lastMessage,d=t.message,u=t.nextMessage;if(!d)return e.createElement("div",null);var p=d&&d.attachments&&d.attachments,m=(s&&s.sender_username===d.sender_username?"0.3em":"1.3em")+" 1.3em 1.3em "+(u&&u.sender_username===d.sender_username?"0.3em":"1.3em");return e.createElement("div",{style:{width:"100%",paddingBottom:u&&u.sender_username===d.sender_username?"2px":"12px"},className:"ce-message-row ce-their-message"},(!s||s.sender_username!==d.sender_username)&&e.createElement("div",{style:Mn.nameText,className:"ce-their-message-sender"},d.sender_username),e.createElement(G,{style:{paddingLeft:"2px"},className:"ce-their-message-row"},e.createElement(J,{xs:12,sm:12,md:12},e.createElement("div",{style:{height:"0px"},className:"ce-their-message-avatar"},(!u||u.sender_username!==d.sender_username)&&e.createElement(v,{show_online:!1,username:d.sender_username,avatar:d.sender&&d.sender.avatar})),e.createElement("div",{style:{display:"auto",paddingLeft:"50px"},className:"ce-their-message-attachments-container ce-their-message-images-container"},function(){var n=t.message;return(n&&n.attachments?n.attachments:[]).map(function(t,n){var r=Jt(t.file);return Gt(r)?e.createElement(qn,{attachment:t,key:"attachment_"+n}):e.createElement("div",{key:"attachment"+n})})}()),e.createElement("div",{style:{display:"auto",paddingLeft:"50px"},className:"ce-their-message-attachments-container ce-their-message-files-container"},function(){var n=t.message;return(n&&n.attachments?n.attachments:[]).map(function(t,n){var r=Jt(t.file);return Gt(r)?e.createElement("div",{key:"attachment"+n}):e.createElement(bn,{attachment:t,key:"attachment_"+n})})}()),!p||d.text&&e.createElement("div",{style:{paddingLeft:"48px"}},e.createElement("div",{className:"ce-message-bubble ce-their-message-bubble",style:re({},Mn.theirMessage,{borderRadius:m}),onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)}},e.createElement(Cn,{text:d.text}))),e.createElement("span",{className:"ce-message-timestamp ce-their-message-timestamp",style:re({},Mn.timeTag,{opacity:a?"1":"0"})},r(Z(d.created),"time"))),e.createElement(J,{xs:9,style:{marginLeft:"48px"},className:"ce-reads-row ce-their-reads-row"},function(){var n=t.chat,r=t.message;return n?n.people.map(function(t,n){return e.createElement(C,{key:"read_"+n,avatar:t.person.avatar,username:t.person.username,visible:r.id===t.last_read,style:{float:"left",marginLeft:"4px"}})}):e.createElement("div",null)}())))},Mn={theirMessage:{cursor:"pointer",color:"black",float:"left",padding:"12px",fontSize:"15px",whiteSpace:"pre-line",backgroundColor:"#f1f0f0",overflowWrap:"anywhere",maxWidth:"calc(100% - 100px)",transition:"all .33s ease",WebkitTransition:"all .33s ease",MozTransition:"all .33s ease"},nameText:{paddingLeft:"62px",paddingBottom:"2px",color:"rgba(0, 0, 0, .40)",fontSize:"15px"},timeTag:{position:"relative",top:"calc(50% - 12px)",left:"8px",fontSize:"14px",color:"rgba(0, 0, 0, 0.4)",transition:"all .15s ease",WebkitTransition:"all .15s ease",MozTransition:"all .15s ease"}},Tn=function(t){var n=t.lastMessage,r=t.message,l=t.nextMessage,a=t.chat,i=o(te).conn;return r&&a&&i&&null!==i?e.createElement("div",{className:"ce-message-and-date"},e.createElement(hn,{lastCreated:n?n.created:null,created:r.created,offset:i.offset}),r.sender_username===i.userName||r.sender_username===i.senderUsername?e.createElement(Sn,{chat:a,conn:i,sending:!r.id,lastMessage:n,message:r,nextMessage:l}):e.createElement(_n,{chat:a,conn:i,lastMessage:n,message:r,nextMessage:l})):e.createElement("div",null)},On=function(t){var n=o(te),r=n.conn,l=n.chats,a=n.messages,i=n.setIsBottomVisible,s=l&&l[n.activeChat],c=Object.keys(a);return r&&null!==r&&s?c.map(function(n,o){var l=a[n],d=0===o?null:c[o-1],u=o===c.length-1?null:c[o+1];return t.renderMessageBubble?e.createElement("div",{key:"message_"+o},o===c.length-1&&e.createElement(Pt,{id:"ce-first-message-render-trigger",onEnter:function(){return i(!0)},onLeave:function(){return i(!1)}}),t.renderMessageBubble(r,s,a[d],l,a[u])):e.createElement("div",{key:"message_"+o,id:"ce-message-"+l.id},o===c.length-1&&e.createElement(Pt,{id:"ce-last-message-render-trigger",onEnter:function(){return i(!0)},onLeave:function(){return i(!1)}}),e.createElement(Tn,{chat:s,message:l,lastMessage:a[d],nextMessage:a[u]}))}):e.createElement("div",null)},In=function(){var t=r(!1),a=n(Date.now()),i=a[0],s=a[1],c=o(te),d=c.conn,u=c.activeChat,p=c.typingCounter,m=c.userCallbacks.translate,f=p&&p[u]?p[u]:[];return l(function(){t.current||(t.current=!0,setInterval(function(){s(Date.now())},1e3))}),d&&null!==d?e.createElement("div",null,Object.keys(f).map(function(t,n){return d.userName!==t&&i<f[t]+2e3?e.createElement("div",{key:"typer_"+n,className:"ce-user-typing-text",style:{color:wn(t),padding:"2px",paddingLeft:"12px"}},t+" "+m("is typing...","IsTyping")):e.createElement("div",{key:"typer_"+n})})):e.createElement("div",null)},zn=["jpg","jpeg","png","gif","tiff"],Dn=function(e){var t=e.split(".");return t.length>0&&-1!==zn.indexOf(t[t.length-1].toLowerCase())},Rn=function(t){var r=n(!1),o=r[0],l=r[1];return e.createElement("div",{onMouseEnter:function(){return l(!0)},onMouseLeave:function(){return l(!1)},style:re({},jn.filePreview,{paddingRight:o?"6px":"26px"})},e.createElement(P,null)," ",t.file&&t.file.name," "," ",o&&e.createElement(L,{style:jn.closeIcon,onClick:function(){return t.onRemove&&t.onRemove()}}))},jn={filePreview:{padding:"12px",display:"inline-block",position:"relative",border:"1px solid #40a9ff",color:"#434343",borderRadius:"14px"},closeIcon:{}},Fn=function(t){return e.createElement("div",{className:"ce-message-files-row",style:{width:"100%",padding:t.files.lenth>0?"6px 16px":"0px"}},t.files.map(function(n,r){return Dn(n.name)?e.createElement("div",{key:"no_file_"+r}):e.createElement(Rn,{file:n,key:"thumb_"+r,onRemove:function(){return t.onRemove&&t.onRemove(r)}})}))},An=function(t){var r=n(!1),o=r[0],a=r[1],i=n(""),s=i[0],c=i[1];return l(function(){c(URL.createObjectURL(t.file))},[t.file]),e.createElement("div",{style:{padding:"6px",display:"inline-block",position:"relative"},onMouseEnter:function(){return a(!0)},onMouseLeave:function(){return a(!1)}},e.createElement("img",{style:Pn.imageSquare,alt:t.file?t.file.name:"",src:s}),o&&e.createElement(L,{style:Pn.closeIcon,onClick:function(){return t.onRemove&&t.onRemove()}}))},Pn={imageSquare:{height:"108px",width:"108px",border:"1px solid #afafaf",borderRadius:"8px",objectFit:"cover",display:"inline"},closeIcon:{position:"absolute",bottom:"calc(100% - 32px)",left:"96px",width:"0px",cursor:"pointer"}},Ln=function(t){return e.createElement("div",{className:"ce-message-images-row",style:{width:"100%",paddingLeft:"12px"}},t.files.map(function(n,r){return Dn(n.name)?e.createElement(An,{file:n,key:"thumb_"+r,onRemove:function(){return t.onRemove&&t.onRemove(r)}}):e.createElement("div",{key:"no_thumb_"+r})}))},Bn=function(t){var r=n({hovered:!1}),o=r[0],l=r[1];return e.createElement("form",{className:"uploader",encType:"multipart/form-data",style:{height:"0px"}},e.createElement("label",{htmlFor:"files",id:"upload-document-button"},e.createElement(B,{className:"ce-attachment-icon",onMouseEnter:function(){return l(re({},o,{hovered:!0}))},onMouseLeave:function(){return l(re({},o,{hovered:!1}))},style:re({},$n.icon,{color:o.hovered?"#06c":"#444"})})),e.createElement("input",{multiple:!0,id:"files",style:{visibility:"hidden"},type:"file",onChange:function(e){return n=Array.from(e.target.files),void(t.onSelectFiles&&t.onSelectFiles(n));var n},onClick:function(e){return e.target.value=null}}))},$n={icon:{background:"none",border:"none",cursor:"pointer",display:"inline-block",float:"left",height:"24px",padding:"4px 5px",width:"28px"}},Hn=function(){var t=n(!1),r=t[1];return e.createElement("div",{id:"ce-send-message-button",onMouseEnter:function(){return r(!0)},onMouseLeave:function(){return r(!1)},style:{cursor:"pointer",backgroundColor:t[0]?"#40a9ff":"#1890ff",display:"inline-block",padding:"8px 14px",borderRadius:"8px"}},e.createElement($,{style:{color:"white",fontSize:"1.5em"}}))},Wn={toolbar:{container:"#toolbar"}},Vn=["bold","italic","underline","strike","code","list","bullet","indent","link","code"],Kn=function(t){function n(e){var n;return n=t.call(this,e)||this,document&&(n.quill=require("react-quill")),n}return oe(n,t),n.prototype.render=function(){var t=this,n=this.quill,r=this.props.translate;return n?e.createElement("div",{className:"ce-quill-container"},e.createElement(n,{theme:"snow",modules:Wn,formats:Vn,value:this.props.value,onChange:this.props.onChange,onKeyDown:function(e){13===e.keyCode&&t.props.onSubmit()}}),e.createElement("div",{id:"toolbar"},e.createElement("button",{className:"ql-bold"}),e.createElement("button",{className:"ql-italic"}),e.createElement("button",{className:"ql-underline"}),e.createElement("button",{className:"ql-strike"}),e.createElement("button",{className:"ql-code"}),e.createElement("button",{className:"ql-link"}),e.createElement(Bn,{onSelectFiles:function(e){return t.props.onAttach(e)}}),e.createElement("div",{className:"ce-send-button-container",onClick:this.props.onSubmit.bind(this),style:{position:"absolute",right:"5px",bottom:"1px"}},e.createElement(Hn,null))),e.createElement("style",null,"\n                /*!\n                * Quill Editor v1.3.7\n                * https://quilljs.com/\n                * Copyright (c) 2014, Jason Chen\n                * Copyright (c) 2013, salesforce.com\n                */\n                .ql-container{box-sizing:border-box;font-family:Helvetica,Arial,sans-serif;font-size:13px;height:100%;margin:0;position:relative}.ql-container.ql-disabled .ql-tooltip{visibility:hidden}.ql-container.ql-disabled .ql-editor ul[data-checked]>li::before{pointer-events:none}.ql-clipboard{left:-100000px;height:1px;overflow-y:hidden;position:absolute;top:50%}.ql-clipboard p{margin:0;padding:0}.ql-editor{box-sizing:border-box;line-height:1.42;height:100%;outline:0;overflow-y:auto;padding:12px 15px;tab-size:4;-moz-tab-size:4;text-align:left;white-space:pre-wrap;word-wrap:break-word}.ql-editor>*{cursor:text}.ql-editor blockquote,.ql-editor h1,.ql-editor h2,.ql-editor h3,.ql-editor h4,.ql-editor h5,.ql-editor h6,.ql-editor ol,.ql-editor p,.ql-editor pre,.ql-editor ul{margin:0;padding:0;counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol,.ql-editor ul{padding-left:1.5em}.ql-editor ol>li,.ql-editor ul>li{list-style-type:none}.ql-editor ul>li::before{content:{};}.ql-editor ul[data-checked=false]{pointer-events:none}.ql-editor ul[data-checked=false]>li *,.ql-editor ul[data-checked=true]>li *{pointer-events:all}.ql-editor ul[data-checked=false]>li::before,.ql-editor ul[data-checked=true]>li::before{color:#777;cursor:pointer;pointer-events:all}.ql-editor ul[data-checked=true]>li::before{content:{};}.ql-editor li:not(.ql-direction-rtl)::before{margin-left:-1.5em;margin-right:.3em;text-align:right}.ql-editor li.ql-direction-rtl::before{margin-left:.3em;margin-right:-1.5em}.ql-editor ol li:not(.ql-direction-rtl),.ql-editor ul li:not(.ql-direction-rtl){padding-left:1.5em}.ql-editor ol li.ql-direction-rtl,.ql-editor ul li.ql-direction-rtl{padding-right:1.5em}.ql-editor ol li{counter-reset:list-1 list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9;counter-increment:list-0}.ql-editor ol li:before{content:counter(list-0,decimal) '. '}.ql-editor ol li.ql-indent-1{counter-increment:list-1}.ql-editor ol li.ql-indent-1:before{content:counter(list-1,lower-alpha) '. '}.ql-editor ol li.ql-indent-1{counter-reset:list-2 list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-2{counter-increment:list-2}.ql-editor ol li.ql-indent-2:before{content:counter(list-2,lower-roman) '. '}.ql-editor ol li.ql-indent-2{counter-reset:list-3 list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-3{counter-increment:list-3}.ql-editor ol li.ql-indent-3:before{content:counter(list-3,decimal) '. '}.ql-editor ol li.ql-indent-3{counter-reset:list-4 list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-4{counter-increment:list-4}.ql-editor ol li.ql-indent-4:before{content:counter(list-4,lower-alpha) '. '}.ql-editor ol li.ql-indent-4{counter-reset:list-5 list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-5{counter-increment:list-5}.ql-editor ol li.ql-indent-5:before{content:counter(list-5,lower-roman) '. '}.ql-editor ol li.ql-indent-5{counter-reset:list-6 list-7 list-8 list-9}.ql-editor ol li.ql-indent-6{counter-increment:list-6}.ql-editor ol li.ql-indent-6:before{content:counter(list-6,decimal) '. '}.ql-editor ol li.ql-indent-6{counter-reset:list-7 list-8 list-9}.ql-editor ol li.ql-indent-7{counter-increment:list-7}.ql-editor ol li.ql-indent-7:before{content:counter(list-7,lower-alpha) '. '}.ql-editor ol li.ql-indent-7{counter-reset:list-8 list-9}.ql-editor ol li.ql-indent-8{counter-increment:list-8}.ql-editor ol li.ql-indent-8:before{content:counter(list-8,lower-roman) '. '}.ql-editor ol li.ql-indent-8{counter-reset:list-9}.ql-editor ol li.ql-indent-9{counter-increment:list-9}.ql-editor ol li.ql-indent-9:before{content:counter(list-9,decimal) '. '}.ql-editor .ql-indent-1:not(.ql-direction-rtl){padding-left:3em}.ql-editor li.ql-indent-1:not(.ql-direction-rtl){padding-left:4.5em}.ql-editor .ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:3em}.ql-editor li.ql-indent-1.ql-direction-rtl.ql-align-right{padding-right:4.5em}.ql-editor .ql-indent-2:not(.ql-direction-rtl){padding-left:6em}.ql-editor li.ql-indent-2:not(.ql-direction-rtl){padding-left:7.5em}.ql-editor .ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:6em}.ql-editor li.ql-indent-2.ql-direction-rtl.ql-align-right{padding-right:7.5em}.ql-editor .ql-indent-3:not(.ql-direction-rtl){padding-left:9em}.ql-editor li.ql-indent-3:not(.ql-direction-rtl){padding-left:10.5em}.ql-editor .ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:9em}.ql-editor li.ql-indent-3.ql-direction-rtl.ql-align-right{padding-right:10.5em}.ql-editor .ql-indent-4:not(.ql-direction-rtl){padding-left:12em}.ql-editor li.ql-indent-4:not(.ql-direction-rtl){padding-left:13.5em}.ql-editor .ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:12em}.ql-editor li.ql-indent-4.ql-direction-rtl.ql-align-right{padding-right:13.5em}.ql-editor .ql-indent-5:not(.ql-direction-rtl){padding-left:15em}.ql-editor li.ql-indent-5:not(.ql-direction-rtl){padding-left:16.5em}.ql-editor .ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:15em}.ql-editor li.ql-indent-5.ql-direction-rtl.ql-align-right{padding-right:16.5em}.ql-editor .ql-indent-6:not(.ql-direction-rtl){padding-left:18em}.ql-editor li.ql-indent-6:not(.ql-direction-rtl){padding-left:19.5em}.ql-editor .ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:18em}.ql-editor li.ql-indent-6.ql-direction-rtl.ql-align-right{padding-right:19.5em}.ql-editor .ql-indent-7:not(.ql-direction-rtl){padding-left:21em}.ql-editor li.ql-indent-7:not(.ql-direction-rtl){padding-left:22.5em}.ql-editor .ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:21em}.ql-editor li.ql-indent-7.ql-direction-rtl.ql-align-right{padding-right:22.5em}.ql-editor .ql-indent-8:not(.ql-direction-rtl){padding-left:24em}.ql-editor li.ql-indent-8:not(.ql-direction-rtl){padding-left:25.5em}.ql-editor .ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:24em}.ql-editor li.ql-indent-8.ql-direction-rtl.ql-align-right{padding-right:25.5em}.ql-editor .ql-indent-9:not(.ql-direction-rtl){padding-left:27em}.ql-editor li.ql-indent-9:not(.ql-direction-rtl){padding-left:28.5em}.ql-editor .ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:27em}.ql-editor li.ql-indent-9.ql-direction-rtl.ql-align-right{padding-right:28.5em}.ql-editor .ql-video{display:block;max-width:100%}.ql-editor .ql-video.ql-align-center{margin:0 auto}.ql-editor .ql-video.ql-align-right{margin:0 0 0 auto}.ql-editor .ql-bg-black{background-color:#000}.ql-editor .ql-bg-red{background-color:#e60000}.ql-editor .ql-bg-orange{background-color:#f90}.ql-editor .ql-bg-yellow{background-color:#ff0}.ql-editor .ql-bg-green{background-color:#008a00}.ql-editor .ql-bg-blue{background-color:#06c}.ql-editor .ql-bg-purple{background-color:#93f}.ql-editor .ql-color-white{color:#fff}.ql-editor .ql-color-red{color:#e60000}.ql-editor .ql-color-orange{color:#f90}.ql-editor .ql-color-yellow{color:#ff0}.ql-editor .ql-color-green{color:#008a00}.ql-editor .ql-color-blue{color:#06c}.ql-editor .ql-color-purple{color:#93f}.ql-editor .ql-font-serif{font-family:Georgia,Times New Roman,serif}.ql-editor .ql-font-monospace{font-family:Monaco,Courier New,monospace}.ql-editor .ql-size-small{font-size:.75em}.ql-editor .ql-size-large{font-size:1.5em}.ql-editor .ql-size-huge{font-size:2.5em}.ql-editor .ql-direction-rtl{direction:rtl;text-align:inherit}.ql-editor .ql-align-center{text-align:center}.ql-editor .ql-align-justify{text-align:justify}.ql-editor .ql-align-right{text-align:right}.ql-editor.ql-blank::before{color:rgba(0,0,0,.6);content:attr(data-placeholder);font-style:italic;left:15px;pointer-events:none;position:absolute;right:15px}.ql-snow .ql-toolbar:after,.ql-snow.ql-toolbar:after{clear:both;content:'';display:table}.ql-snow .ql-toolbar button,.ql-snow.ql-toolbar button{background:0 0;border:none;cursor:pointer;display:inline-block;float:left;height:24px;padding:3px 5px;width:28px}.ql-snow .ql-toolbar button svg,.ql-snow.ql-toolbar button svg{float:left;height:100%}.ql-snow .ql-toolbar button:active:hover,.ql-snow.ql-toolbar button:active:hover{outline:0}.ql-snow .ql-toolbar input.ql-image[type=file],.ql-snow.ql-toolbar input.ql-image[type=file]{display:none}.ql-snow .ql-toolbar .ql-picker-item.ql-selected,.ql-snow .ql-toolbar .ql-picker-item:hover,.ql-snow .ql-toolbar .ql-picker-label.ql-active,.ql-snow .ql-toolbar .ql-picker-label:hover,.ql-snow .ql-toolbar button.ql-active,.ql-snow .ql-toolbar button:focus,.ql-snow .ql-toolbar button:hover,.ql-snow.ql-toolbar .ql-picker-item.ql-selected,.ql-snow.ql-toolbar .ql-picker-item:hover,.ql-snow.ql-toolbar .ql-picker-label.ql-active,.ql-snow.ql-toolbar .ql-picker-label:hover,.ql-snow.ql-toolbar button.ql-active,.ql-snow.ql-toolbar button:focus,.ql-snow.ql-toolbar button:hover{color:#06c}.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-fill,.ql-snow .ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:focus .ql-fill,.ql-snow .ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow .ql-toolbar button:hover .ql-fill,.ql-snow .ql-toolbar button:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-fill,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-fill,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-fill,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke.ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-fill,.ql-snow.ql-toolbar button.ql-active .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:focus .ql-fill,.ql-snow.ql-toolbar button:focus .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:hover .ql-fill,.ql-snow.ql-toolbar button:hover .ql-stroke.ql-fill{fill:#06c}.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow .ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow .ql-toolbar button.ql-active .ql-stroke,.ql-snow .ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow .ql-toolbar button:focus .ql-stroke,.ql-snow .ql-toolbar button:focus .ql-stroke-miter,.ql-snow .ql-toolbar button:hover .ql-stroke,.ql-snow .ql-toolbar button:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item.ql-selected .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-item:hover .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke,.ql-snow.ql-toolbar .ql-picker-label:hover .ql-stroke-miter,.ql-snow.ql-toolbar button.ql-active .ql-stroke,.ql-snow.ql-toolbar button.ql-active .ql-stroke-miter,.ql-snow.ql-toolbar button:focus .ql-stroke,.ql-snow.ql-toolbar button:focus .ql-stroke-miter,.ql-snow.ql-toolbar button:hover .ql-stroke,.ql-snow.ql-toolbar button:hover .ql-stroke-miter{stroke:#06c}@media (pointer:coarse){.ql-snow .ql-toolbar button:hover:not(.ql-active),.ql-snow.ql-toolbar button:hover:not(.ql-active){color:#444}.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-fill,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow .ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke,.ql-snow.ql-toolbar button:hover:not(.ql-active) .ql-stroke-miter{stroke:#444}}.ql-snow{box-sizing:border-box}.ql-snow *{box-sizing:border-box}.ql-snow .ql-hidden{display:none}.ql-snow .ql-out-bottom,.ql-snow .ql-out-top{visibility:hidden}.ql-snow .ql-tooltip{position:absolute;transform:translateY(10px)}.ql-snow .ql-tooltip a{cursor:pointer;text-decoration:none}.ql-snow .ql-tooltip.ql-flip{transform:translateY(-10px)}.ql-snow .ql-formats{display:inline-block;vertical-align:middle}.ql-snow .ql-formats:after{clear:both;content:'';display:table}.ql-snow .ql-stroke{fill:none;stroke:#444;stroke-linecap:round;stroke-linejoin:round;stroke-width:2}.ql-snow .ql-stroke-miter{fill:none;stroke:#444;stroke-miterlimit:10;stroke-width:2}.ql-snow .ql-fill,.ql-snow .ql-stroke.ql-fill{fill:#444}.ql-snow .ql-empty{fill:none}.ql-snow .ql-even{fill-rule:evenodd}.ql-snow .ql-stroke.ql-thin,.ql-snow .ql-thin{stroke-width:1}.ql-snow .ql-transparent{opacity:.4}.ql-snow .ql-direction svg:last-child{display:none}.ql-snow .ql-direction.ql-active svg:last-child{display:inline}.ql-snow .ql-direction.ql-active svg:first-child{display:none}.ql-snow .ql-editor h1{font-size:2em}.ql-snow .ql-editor h2{font-size:1.5em}.ql-snow .ql-editor h3{font-size:1.17em}.ql-snow .ql-editor h4{font-size:1em}.ql-snow .ql-editor h5{font-size:.83em}.ql-snow .ql-editor h6{font-size:.67em}.ql-snow .ql-editor a{text-decoration:underline}.ql-snow .ql-editor blockquote{border-left:4px solid #ccc;margin-bottom:5px;margin-top:5px;padding-left:16px}.ql-snow .ql-editor code,.ql-snow .ql-editor pre{background-color:#f0f0f0;border-radius:3px}.ql-snow .ql-editor pre{white-space:pre-wrap;margin-bottom:5px;margin-top:5px;padding:5px 10px}.ql-snow .ql-editor code{font-size:85%;padding:2px 4px}.ql-snow .ql-editor pre.ql-syntax{background-color:#23241f;color:#f8f8f2;overflow:visible}.ql-snow .ql-editor img{max-width:100%}.ql-snow .ql-picker{color:#444;display:inline-block;float:left;font-size:14px;font-weight:500;height:24px;position:relative;vertical-align:middle}.ql-snow .ql-picker-label{cursor:pointer;display:inline-block;height:100%;padding-left:8px;padding-right:2px;position:relative;width:100%}.ql-snow .ql-picker-label::before{display:inline-block;line-height:22px}.ql-snow .ql-picker-options{background-color:#fff;display:none;min-width:100%;padding:4px 8px;position:absolute;white-space:nowrap}.ql-snow .ql-picker-options .ql-picker-item{cursor:pointer;display:block;padding-bottom:5px;padding-top:5px}.ql-snow .ql-picker.ql-expanded .ql-picker-label{color:#ccc;z-index:2}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-fill{fill:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-label .ql-stroke{stroke:#ccc}.ql-snow .ql-picker.ql-expanded .ql-picker-options{display:block;margin-top:-1px;top:100%;z-index:1}.ql-snow .ql-color-picker,.ql-snow .ql-icon-picker{width:28px}.ql-snow .ql-color-picker .ql-picker-label,.ql-snow .ql-icon-picker .ql-picker-label{padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-label svg,.ql-snow .ql-icon-picker .ql-picker-label svg{right:4px}.ql-snow .ql-icon-picker .ql-picker-options{padding:4px 0}.ql-snow .ql-icon-picker .ql-picker-item{height:24px;width:24px;padding:2px 4px}.ql-snow .ql-color-picker .ql-picker-options{padding:3px 5px;width:152px}.ql-snow .ql-color-picker .ql-picker-item{border:1px solid transparent;float:left;height:16px;margin:2px;padding:0;width:16px}.ql-snow .ql-picker:not(.ql-color-picker):not(.ql-icon-picker) svg{position:absolute;margin-top:-9px;right:0;top:50%;width:18px}.ql-snow .ql-picker.ql-font .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-item[data-label]:not([data-label=''])::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-label]:not([data-label=''])::before{content:attr(data-label)}.ql-snow .ql-picker.ql-header{width:98px}.ql-snow .ql-picker.ql-header .ql-picker-item::before,.ql-snow .ql-picker.ql-header .ql-picker-label::before{content:'"+r("Normal","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="1"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="1"]::before{content:\''+r("Heading 1","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="2"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="2"]::before{content:\''+r("Heading 2","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="3"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="3"]::before{content:\''+r("Heading 3","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="4"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="4"]::before{content:\''+r("Heading 4","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="5"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="5"]::before{content:\''+r("Heading 5","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="6"]::before,.ql-snow .ql-picker.ql-header .ql-picker-label[data-value="6"]::before{content:\''+r("Heading 6","FormHtmlEditor")+'\'}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="1"]::before{font-size:2em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="2"]::before{font-size:1.5em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="3"]::before{font-size:1.17em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="4"]::before{font-size:1em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="5"]::before{font-size:.83em}.ql-snow .ql-picker.ql-header .ql-picker-item[data-value="6"]::before{font-size:.67em}.ql-snow .ql-picker.ql-font{width:108px}.ql-snow .ql-picker.ql-font .ql-picker-item::before,.ql-snow .ql-picker.ql-font .ql-picker-label::before{content:\''+r("Sans Serif","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=serif]::before{content:'"+r("Serif","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before,.ql-snow .ql-picker.ql-font .ql-picker-label[data-value=monospace]::before{content:'"+r("Monospace","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=serif]::before{font-family:Georgia,Times New Roman,serif}.ql-snow .ql-picker.ql-font .ql-picker-item[data-value=monospace]::before{font-family:Monaco,Courier New,monospace}.ql-snow .ql-picker.ql-size{width:98px}.ql-snow .ql-picker.ql-size .ql-picker-item::before,.ql-snow .ql-picker.ql-size .ql-picker-label::before{content:'"+r("Normal","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=small]::before{content:'"+r("Small","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=large]::before{content:'"+r("Large","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before,.ql-snow .ql-picker.ql-size .ql-picker-label[data-value=huge]::before{content:'"+r("Huge","FormHtmlEditor")+"'}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=small]::before{font-size:10px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=large]::before{font-size:18px}.ql-snow .ql-picker.ql-size .ql-picker-item[data-value=huge]::before{font-size:32px}.ql-snow .ql-color-picker.ql-background .ql-picker-item{background-color:#fff}.ql-snow .ql-color-picker.ql-color .ql-picker-item{background-color:#000}.ql-toolbar.ql-snow{border:1px solid #ccc;box-sizing:border-box;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;padding:8px}.ql-toolbar.ql-snow .ql-formats{margin-right:15px}.ql-toolbar.ql-snow .ql-picker-label{border:1px solid transparent}.ql-toolbar.ql-snow .ql-picker-options{border:1px solid transparent;box-shadow:rgba(0,0,0,.2) 0 2px 8px}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-label{border-color:#ccc}.ql-toolbar.ql-snow .ql-picker.ql-expanded .ql-picker-options{border-color:#ccc}.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item.ql-selected,.ql-toolbar.ql-snow .ql-color-picker .ql-picker-item:hover{border-color:#000}.ql-toolbar.ql-snow+.ql-container.ql-snow{border-top:0}.ql-snow .ql-tooltip{background-color:#fff;border:1px solid #ccc;box-shadow:0 0 5px #ddd;color:#444;padding:5px 12px;white-space:nowrap}.ql-snow .ql-tooltip::before{content:\""+r("Visit URL:","FormHtmlEditor")+"\";line-height:26px;margin-right:8px}.ql-snow .ql-tooltip input[type=text]{display:none;border:1px solid #ccc;font-size:13px;height:26px;margin:0;padding:3px 5px;width:170px}.ql-snow .ql-tooltip a.ql-preview{display:inline-block;max-width:200px;overflow-x:hidden;text-overflow:ellipsis;vertical-align:top}.ql-snow .ql-tooltip a.ql-action::after{border-right:1px solid #ccc;content:'"+r("Edit","FormHtmlEditor")+"';margin-left:16px;padding-right:8px}.ql-snow .ql-tooltip a.ql-remove::before{content:'"+r("Remove","FormHtmlEditor")+"';margin-left:8px}.ql-snow .ql-tooltip a{line-height:26px}.ql-snow .ql-tooltip.ql-editing a.ql-preview,.ql-snow .ql-tooltip.ql-editing a.ql-remove{display:none}.ql-snow .ql-tooltip.ql-editing input[type=text]{display:inline-block}.ql-snow .ql-tooltip.ql-editing a.ql-action::after{border-right:0;content:'"+r("Save","FormHtmlEditor")+"';padding-right:0}.ql-snow .ql-tooltip[data-mode=link]::before{content:\""+r("Enter link:","FormHtmlEditor")+'"}.ql-snow .ql-tooltip[data-mode=formula]::before{content:"'+r("Enter formula:","FormHtmlEditor")+'"}.ql-snow .ql-tooltip[data-mode=video]::before{content:"'+r("Enter video:","FormHtmlEditor")+'"}.ql-snow a{color:#06c}.ql-container.ql-snow{border:1px solid #ccc}\n                ')):e.createElement("div",null)},n}(i),Un=function(){var t=o(c),r=t.conn,l=t.activeChat,a=t.messages,i=t.setMessages,s=t.userCallbacks,d=s.translate,u=s.onMessageSent,p=n(0),m=p[0],f=p[1],h=n(""),g=h[0],q=h[1],v=n(0),b=v[0],y=v[1],x=n([]),w=x[0],k=x[1];function E(e){var t=w;t.splice(e,1),k(t),f(m+1)}return e.createElement("div",{id:"msg-form-container",style:Gn.NewMessageFormContainer,className:"ce-message-form-container"},e.createElement(Ln,{files:w,onRemove:function(e){return E(e)}}),e.createElement(Fn,{files:w,onRemove:function(e){return E(e)}}),e.createElement(Kn,{theme:"snow",value:g,onChange:function(e){q(e),y((b+1)%4),1===b&&r&&S(r,l)}.bind(void 0),onSubmit:function(){if(r){var e=g.trim();e.length>11&&"<p><br></p>"===e.slice(-11)&&(e=e.substr(0,e.length-11));var t={sender_id:Date.now().toString()},n=r.userName?r.userName:r.senderUsername,o=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),s={text:e,attachments:w,custom_json:t,sender_username:n,chat:l,created:o};if(e.length>0||w.length>0){N(r,l,s,function(){});var c=re({},a);c[s.created]=s,i(c),u(l,s.text,{createdAt:s.created,attachments:s.attachments,senderId:s.custom_json.sender_id,username:s.sender_username})}q(""),k([])}}.bind(void 0),onAttach:k.bind(void 0),translate:d}))},Gn={NewMessageFormContainer:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:"white"}},Jn=function(t){var a=r(!1),i=n(!1),s=i[0],c=i[1],d=o(te),u=d.connecting,p=d.userCallbacks.translate;return l(function(){a.current||(a.current=!0,setTimeout(function(){return c(!0)},t.renderDelay?t.renderDelay:0))}),u&&s?e.createElement("div",{style:{zIndex:"1",bottom:"100px",left:"0",right:"0",position:"absolute",textAlign:"center"}},e.createElement("span",{style:{fontSize:"15px",padding:"10px 22px",color:"white",display:"inline-block",backgroundColor:"#fa8c16",borderRadius:"1.3em"},id:"ce-connecting-popup"},e.createElement(H,{spin:!0})," ",p("Connecting","ConnectionBar"))):e.createElement("div",null)},Yn=function(t){var a=r(!1),i=n(!1),s=i[0],d=i[1],u=o(c),p=u.conn,m=u.isBottomVisible,f=u.userCallbacks.translate,h=t.chat;if(l(function(){a.current||(a.current=!0,setTimeout(function(){return d(!0)},t.renderDelay?t.renderDelay:0))}),null===p||!h||null===h)return e.createElement("div",null);var g=void 0;return h.people.map(function(e){e.person.username===p.userName&&(g=e.last_read)}),!s||m||void 0===h.last_message.id||h.last_message.id===g?e.createElement("div",null):e.createElement("div",{style:{zIndex:"1",bottom:"100px",left:"0",right:"0",position:"absolute",textAlign:"center"}},e.createElement("div",{style:{fontSize:"15px",padding:"10px 22px",color:"white",display:"inline-block",backgroundColor:"#389e0d",borderRadius:"1.3em",cursor:"pointer"},id:"ce-scroll-down-bar",onClick:function(){return X.scrollToBottom({duration:333,containerId:"ce-feed-container"})}},e.createElement(W,null)," ",f(p.userName?"Unread Messages":"Scroll to Bottom","ScrollDownBar")))},Xn=45,Zn=function(t){var r=n(!1),a=r[0],i=r[1],d=n(!1),m=d[0],f=d[1],h=n(!1),g=h[0],q=h[1],v=n(null),b=v[0],y=v[1],x=o(c),w=x.conn,k=x.chats,E=x.setChats,C=x.messages,S=x.setMessages,N=x.activeChat,_=x.setActiveChat,M=x.loadMoreMessages,T=x.setLoadMoreMessages,O=x.isBottomVisible,I=x.typingCounter,z=I&&I[N]?I[N]:[],D=k&&k[b],R=a&&s.isEmpty(C);function j(e){if(k){var t=re({},k);t[e.id]=e,E(t)}}function F(e,n,r){if(i(!0),S(s.mapKeys(n,"created")),n.length>0){var o=n[n.length-1];t.userName&&t.userName!==o.sender_username&&p(w,e,o.id,function(e){return j(e)})}r&&X.scrollToBottom({duration:0,containerId:r}),t.onGetMessages&&t.onGetMessages(e,n)}function A(e){e?(Xn+=33,T(!1),u(w,N,Xn,function(e,t){return F(e,t,!1)})):w&&!t.activeChat&&null!==N&&N!==b?(Xn=45,y(N),u(w,N,Xn,function(e,t){return F(e,t,"ce-feed-container")})):w&&t.activeChat&&t.activeChat!==b&&(Xn=45,_(t.activeChat),y(t.activeChat),u(w,t.activeChat,Xn,function(e,t){return F(e,t,"ce-feed-container")}))}function P(e,t){var n=void 0;return t.people.map(function(t){t.person.username===e&&(n=t.last_read)}),n}return l(function(){A(!1)},[w,N,b]),l(function(){A(M)},[M]),l(function(){O&&!s.isEmpty(C)&&(setTimeout(function(){X.scrollToBottom({duration:333,containerId:"ce-feed-container"})},100),P(w.userName,D)&&P(w.userName,D)!==D.last_message.id&&p(w,b,D.last_message.id,function(e){return j(e)}))},[C,O]),void 0===w?e.createElement(Ie,t):w&&null!==k&&0===Object.values(k).filter(function(e){return e}).length?e.createElement(Ft,{conn:w}):e.createElement("div",{className:"ce-chat-feed",style:{height:"100%",maxHeight:"100vh",backgroundColor:"#f0f0f0"}},t.renderChatHeader?t.renderChatHeader(D,{chatListIsOpen:m,setChatListIsOpen:f,chatSettingsIsOpen:g,setChatSettingsIsOpen:q}):e.createElement(cn,{setChatListIsOpen:f,setChatSettingsIsOpen:q}),e.createElement(un,{chatListIsOpen:m,setChatListIsOpen:f}),e.createElement(mn,{chatSettingsIsOpen:g,setChatSettingsIsOpen:q}),e.createElement("div",{id:"ce-feed-container",style:Qn.feedContainer,className:"ce-chat-feed-container"},e.createElement("div",{style:{height:"88px"},className:"ce-feed-container-top"}),Object.keys(C).length>0&&e.createElement(Pt,{onEnter:function(){return T(!0)}}),R&&t.renderIceBreaker&&t.renderIceBreaker(D),R&&!t.renderIceBreaker&&e.createElement(At,null),e.createElement(On,t),t.renderIsTyping?t.renderIsTyping(z):e.createElement(In,null),t.renderConnectionBar?t.renderConnectionBar(D):e.createElement(Jn,{renderDelay:1e4}),t.renderScrollDownBar?t.renderScrollDownBar(D):e.createElement(Yn,{chat:D,renderDelay:3e3}),e.createElement("div",{style:{height:"86px"},className:"ce-feed-container-bottom"})),t.renderNewMessageForm?t.renderNewMessageForm(t,b):e.createElement(Un,null))},Qn={feedContainer:{width:"100%",height:"100%",maxHeight:"100vh",overflowX:"hidden",overflowY:"scroll",backgroundColor:"white"}};U({maxScreenClass:"xs",gutterWidth:0});var er=function(t){var n=o(te),r=t.height,l=re({},t,n),a=Object.keys(t).filter(function(e){return e.match(/^on[A-Z][a-z]/)&&"onMessageSent"!==e}).reduce(function(e,n){return e[n]=t[n],e},{});return e.createElement("div",re({},a,{className:"ce-chat-engine",style:{textAlign:"left",backgroundColor:"white"}}),e.createElement(me,t),e.createElement(G,{className:"ce-wrapper"},e.createElement(J,{xs:0,sm:3,style:{height:r||""},className:"ce-chat-list-column"},t.renderChatList?t.renderChatList(l):e.createElement(Te,re({},l,{onChatClick:function(e){t.renderChatFeed&&u(t,e,45,function(e,t){n.setMessages(re({},s.mapKeys(t,"created")))})}}))),e.createElement(J,{xs:12,sm:6,style:{height:r||""},className:"ce-chat-feed-column"},t.renderChatFeed?t.renderChatFeed(l):e.createElement(Zn,l)),e.createElement(J,{xs:0,sm:3,style:{height:r||""},className:"ce-settings-column"},t.renderChatSettings?t.renderChatSettings(t):e.createElement(rn,t))))},tr=function(t){return o(te)?e.createElement(er,t):e.createElement(ne,t,e.createElement(er,t))},nr=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={avatar:""},e}oe(n,t);var r=n.prototype;return r.updateImg=function(){var e=this.props.avatar;(e=e&&null!==e?e:"").split("?")[0]!==this.state.avatar.split("?")[0]&&this.setState({avatar:e})},r.componentDidMount=function(){this.updateImg()},r.componentDidUpdate=function(){this.updateImg()},r.render=function(){var t=this.props,n=t.username,r=t.is_online,o=this.props.style?this.props.style:{},l=n?n.substring(0,2).toUpperCase():"",a=wn(n);return e.createElement("div",{style:{width:"48px",height:"48px"}},e.createElement("div",{style:{height:"0px"}},e.createElement("div",{className:"ce-avatar",style:re({},rr.avatar,o,{backgroundColor:this.state.avatar?"white":a,backgroundImage:this.state.avatar&&"url("+this.state.avatar+")",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"48px"})},e.createElement("div",{className:"ce-avatar-text",style:rr.avatarText},!this.state.avatar&&l))),!1!==this.props.show_online&&e.createElement("div",{className:"ce-avatar-status",style:re({},rr.status,{backgroundColor:r?"#52c41a":"#f5222d"})}))},n}(i),rr={avatar:{width:"44px",height:"44px",borderRadius:"22px",color:"white",textAlign:"center"},avatarText:{color:"white",paddingTop:"12px",fontSize:"15px",fontWeight:"600"},status:{width:"8px",height:"8px",borderRadius:"100%",border:"2px solid white"}};function or(e,t,n,r){M.post(le(e)+"/chats/"+t+"/people/",{username:n},{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("New Person Error",e)})}function lr(e,t,n,r){M.put(le(e)+"/chats/"+t+"/people/",{username:n},{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("Delete Person Error",e)})}function ar(e,t,n,r){M.get(le(e)+"/chats/"+t+"/others/",{headers:ae(e)}).then(function(r){e.onGetOtherPeople&&e.onGetOtherPeople(t,r.data),n&&n(t,r.data)}).catch(function(e){console.log("Fetch Other People Error",e),r&&r()})}function ir(e,t){M.get(le(e)+"/users/me/",{headers:ae(e)}).then(function(e){t&&t(e.data)}).catch(function(e){console.log("Get Myself Error",e)})}function sr(e,t,n){M.patch(le(e)+"/chats/me/",t,{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("Edit Myself Error",e)})}function cr(e,t,n){M.delete(le(e)+"/chats/"+t+"/people/",{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){console.log("Delete Person Error",e)})}function dr(e,t,n){M.get(le(e)+"/chats/"+t+"/messages/",{headers:ae(e)}).then(function(r){e.onGetMessages&&e.onGetMessages(t,r.data),n&&n(t,r.data)}).catch(function(e){console.log("Fetch Messages Error",e)})}function ur(e,t,n,r){ae(e)&&M.get(le(e)+"/chats/"+t+"/messages/latest/"+n+"/",{headers:ae(e)}).then(function(n){e.onGetMessages&&e.onGetMessages(t,n.data),r&&r(t,n.data)}).catch(function(e){console.log("Fetch Latest Messages Error",e)})}function pr(e,t,n,r){var o=new FormData;if(n.attachments)for(var l=0;l<n.attachments.length;l++)o.append("attachments",n.attachments[l],n.attachments[l].name);else if(n.files)for(var a=0;a<n.files.length;a++)o.append("attachments",n.files[a],n.files[a].name);n.created&&o.append("created",n.created),o.append("text",n.text),o.append("sender_username",n.sender_username),o.append("custom_json",JSON.stringify(n.custom_json?n.custom_json:{})),M.post(le(e)+"/chats/"+t+"/messages/",o,{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("Send Messages Error",e)})}function mr(e,t,n,r){M.get(le(e)+"/chats/"+t+"/messages/"+n+"/",{headers:ae(e)}).then(function(e){r&&r(t,e.data)}).catch(function(e){console.log("Fetch Message Error",e)})}function fr(e,t,n,r,o){M.patch(le(e)+"/chats/"+t+"/messages/"+n+"/",r,{headers:ae(e)}).then(function(e){o&&o(e.data)}).catch(function(e){console.log("Delete Messages Error",e)})}function hr(e,t,n,r){M.patch(le(e)+"/chats/"+t+"/people/",{last_read:n},{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("Read Message Error",e)})}function gr(e,t,n,r){M.delete(le(e)+"/chats/"+t+"/messages/"+n+"/",{headers:ae(e)}).then(function(e){r&&r(e.data)}).catch(function(e){console.log("Delete Messages Error",e)})}function qr(e,t,n){M.post(le(e)+"/chats/"+t+"/typing/",{},{headers:ae(e)}).then(function(e){n&&n(e.data)}).catch(function(e){})}nr.propTypes={avatar:Mt.string,username:Mt.string,style:Mt.object,is_online:Mt.bool,show_online:Mt.bool};var vr=function(t){var r,o=n({hovered:!1}),l=o[0],a=o[1];return e.createElement("div",((r={className:"uploader",encType:"multipart/form-data",style:{height:"0px"}}).className="ce-upload-document-form",r),e.createElement("label",{htmlFor:"files",id:"ce-upload-document-button"},e.createElement(B,{id:"ce-upload-document-icon",onMouseEnter:function(){return a(re({},l,{hovered:!0}))},onMouseLeave:function(){return a(re({},l,{hovered:!1}))},style:re({},{cursor:"pointer",position:"absolute",bottom:"20px",right:"63px",fontSize:"18px"},{color:l.hovered?"#69c0ff":"#1890ff"})})),e.createElement("input",{id:"files",accept:"image/x-png,image/gif,image/jpeg",style:{visibility:"hidden"},type:"file",onChange:function(e){return n=Array.from(e.target.files),void(t.onSelectFiles&&t.onSelectFiles(n));var n},onClick:function(e){return e.target.value=null}}))},br=function(t){function n(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).state={value:null,height:0},e}oe(n,t);var r=n.prototype;return r.resize=function(){var e=document.getElementById("msg-textarea");e.style.height="",e.style.height=Math.min(e.scrollHeight,150)+"px",this.setState({height:Math.min(e.scrollHeight,150)})},r.componentDidMount=function(){this.resize()},r.handleChange=function(e){this.resize(),this.props.handleChange&&this.props.handleChange(e)},r.onKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),this.props.value.length>0&&this.props.onSubmit&&this.props.onSubmit(e))},r.render=function(){var t=this;return e.createElement("input",{id:"msg-textarea",className:"ce-input ce-textarea-input",style:yr.input,value:this.props.value,placeholder:this.props.label,onChange:function(e){return t.handleChange(e)},onKeyDown:function(e){return t.onKeyDown(e)}})},n}(i),yr={input:{border:"1px solid white",width:"calc(100% - 100px)",outline:"none",fontSize:"15px",paddingLeft:"12px",paddingRight:"12px",position:"relative",left:"12px",resize:"none",overflowX:"hidden"}},xr=function(){var t=o(c),r=t.conn,l=t.activeChat,a=t.messages,i=t.setMessages,s=t.userCallbacks.translate,d=n(0),u=d[0],p=d[1],m=n(""),f=m[0],h=m[1],g=n(0),q=g[0],v=g[1],b=n([]),y=b[0],x=b[1];if(!r||null===r)return e.createElement("div",null);function w(e){var t=y;t.splice(e,1),x(t),p(u+1)}function k(e){if(e.preventDefault(),r){var t=f.trim();t.length>11&&"<p><br></p>"===t.slice(-11)&&(t=t.substr(0,t.length-11));var n={sender_id:Date.now().toString()},o=r.userName?r.userName:r.senderUsername,s=(new Date).toISOString().replace("T"," ").replace("Z",Math.floor(1e3*Math.random())+"+00:00"),c={text:t,attachments:y,custom_json:n,sender_username:o,chat:l,created:s};(t.length>0||y.length>0)&&N(r,l,c,function(){}),h(""),x([]);var d=re({},a);d[c.created]=c,i(d)}}return e.createElement("div",{id:"ce-social-msg-form-container",style:wr.messageFormContainer,className:"ce-social-message-form-container"},e.createElement(Ln,{files:y,onRemove:function(e){return w(e)}}),e.createElement(Fn,{files:y,onRemove:function(e){return w(e)}}),e.createElement("form",{onSubmit:k.bind(void 0),className:"ce-social-message-form",style:wr.messageForm},e.createElement("button",{icon:"send",type:"submit",id:"ce-send-message-button",style:wr.sendMessage},e.createElement("img",{className:"send-icon",style:wr.sendIcon,src:"https://chat-engine-assets.s3.amazonaws.com/send.png",alt:"chat-engine-send-button"})),e.createElement("div",{style:wr.inputContainer,className:"ce-message-input-form"},e.createElement(vr,{onSelectFiles:function(e){return x(e)}}),e.createElement(br,{value:f,label:s("Send a message...","MessageFormSocial"),handleChange:function(e){h(e.target.value),v((q+1)%4),1===q&&r&&S(r,l)}.bind(void 0),onSubmit:k.bind(void 0)}))))},wr={messageFormContainer:{position:"absolute",bottom:"0px",width:"100%",backgroundColor:"white"},messageForm:{paddingTop:"22px",marginRight:"10px",width:"100%"},inputContainer:{minHeight:"36px",paddingBottom:"16px",width:"100%"},sendMessage:{width:"40px",height:"40px",borderRadius:"50%",borderWidth:"0px",padding:"0px",outline:"none",color:"white",backgroundColor:"rgb(24, 144, 255)",cursor:"pointer",position:"absolute",bottom:"12px",right:"10px",zIndex:"10"},sendIcon:{width:"20px",transform:"rotate(-20deg)",marginLeft:"5px"}};export{zt as AutoCompleteInput,nr as Avatar,Rt as Button,_e as ChatCard,tr as ChatEngine,te as ChatEngineContext,ne as ChatEngineWrapper,Zn as ChatFeed,cn as ChatHeader,Te as ChatList,rn as ChatSettings,nn as ChatSettingsTop,be as ChatSocket,Jn as ConnectionBar,kn as Dot,At as IceBreaker,In as IsTyping,Tn as MessageBubble,xr as MessageFormSocial,xe as NewChatForm,Un as NewMessageForm,Qt as OptionsSettings,Kt as PeopleSettings,Zt as PhotosSettings,Yn as ScrollDownBar,me as Socket,Tt as TextInput,or as addPerson,Le as deleteChat,gr as deleteMessage,Pe as editChat,fr as editMessage,sr as editMyData,Ae as getChat,ze as getChats,je as getChatsBefore,Re as getLatestChats,ur as getLatestMessages,mr as getMessage,dr as getMessages,ir as getMyData,Fe as getOrCreateChat,ar as getOtherPeople,qr as isTyping,cr as leaveChat,De as newChat,hr as readMessage,lr as removePerson,pr as sendMessage};
//# sourceMappingURL=index.modern.js.map
